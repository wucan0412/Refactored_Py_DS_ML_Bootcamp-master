(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1394:function(e,t,n){},1435:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(3);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.selectedKey,i=void 0===o?"selectedProps":o,r=n.dropedKey,s=void 0===r?"dropedProps":r;return Object.keys(e).reduce(function(n,o){var r=t.includes(o)?i:s;return Object.assign({},n,Object(a.a)({},r,Object.assign({},n[r],Object(a.a)({},o,e[o]))))},{})}},1436:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(4),o=n(8),i=n(7),r=n(5),s=n(6),c=n(0),l=n(1),d=n(109),m=(n(1620),function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.onRef;return Object(c.b)("div",{className:"Comments-pattern-loading",ref:e},Object(c.b)(d.a,null))}}]),t}(l.PureComponent))},1437:function(e,t,n){"use strict";var a=n(4),o=n(8),i=n(7),r=n(5),s=n(6),c=n(13),l=n(1),d=n(9),m=n.n(d),u=n(10),p=n(0),b=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(s)))).handleClick=function(){var e=n.props;(0,e.onSelect)(e.page)},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.isCurrent,a=e.className;return Object(p.b)(u.c,{preset:u.b.Plain,className:m()("PaginationButton",{"PaginationButton--current":n},a),onClick:this.handleClick,disabled:n},t)}}]),t}(l.Component),h=(n(1619),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from({length:t},function(t,n){return n+e})}),f=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.onSelect,a=t.className,o=t.clickCallback,i=this.props.current,r=this.props.total,s=o&&(e=o,function(){e.apply(void 0,arguments)})||n,l=function(e,t){var n="...";return t<=5?h(1,t):e>t-3?[1,n].concat(Object(c.a)(h(t-3,3)),[t]):e<=3?[1].concat(Object(c.a)(h(2,3)),[n,t]):[1,n].concat(Object(c.a)(h(e-Math.floor(1.5),3)),[n,t])}(i,r);return Object(p.b)("div",{className:m()("Pagination",a)},i>1&&i<=r&&Object(p.b)(b,{className:"PaginationButton-prev",onSelect:s,text:"上一页",page:i-1}),l.map(function(e,t){return"number"==typeof e?Object(p.b)(b,{onSelect:s,text:e,page:e,key:t,isCurrent:i===e}):Object(p.b)("button",{disabled:!0,key:t,className:"PaginationButton PaginationButton--ellipsis"},e)}),i>0&&i<r&&Object(p.b)(b,{className:"PaginationButton-next",onSelect:s,text:"下一页",page:i+1}))}}]),t}(l.Component);f.defaultProps={current:1,total:1,onSelect:function(){}},n.d(t,"a",function(){return f})},1438:function(e,t,n){"use strict";var a=n(14),o=n(0),i=n(1),r=n.n(i),s=n(149),c=n(16),l=function(e){return r.a.createElement(c.a,e,r.a.createElement("path",{d:"M12 11l-3.716 3.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l4.249-4.512a.758.758 0 0 1 1.064 0l4.246 4.512a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063 0L12.002 11z",fillRule:"evenodd"}))};l.defaultProps={name:"ArrowUp"};var d=l,m=n(73),u=n.n(m);n(1621);function p(e){var t=e.onClick,n=e.commentsElRef,i=r.a.useState(!1),c=Object(a.a)(i,2),l=c[0],m=c[1],p=r.a.useState(0),b=Object(a.a)(p,2),h=b[0],f=b[1];return r.a.useEffect(function(){var e=n.current;if(e){var t=e.getBoundingClientRect().right;f(t-16)}},[n]),r.a.useEffect(function(){var e=u()(function(){var e=n.current;if(e){var t=window.innerHeight,a=e.getBoundingClientRect(),o=a.top,i=a.bottom,r=a.height;m(r>500&&i>t&&o<0)}},100);return window.addEventListener("scroll",e),function(){e.cancel(),window.removeEventListener("scroll",e)}},[n]),Object(s.c)(l,null,{from:{opacity:0,left:h},enter:{opacity:1,left:h},leave:{opacity:0,left:h}}).map(function(e){var n=e.item,a=e.key,i=e.props;return n&&Object(o.b)(s.a.button,{key:a,style:i,onClick:t,className:"CommentCollapseButton"},"收起评论",Object(o.b)(d,{center:!0}))})}n.d(t,"a",function(){return p})},1599:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},1600:function(e,t,n){},1601:function(e,t,n){},1602:function(e,t,n){},1603:function(e,t,n){},1604:function(e,t,n){},1605:function(e,t,n){},1606:function(e,t,n){},1607:function(e,t,n){},1608:function(e,t,n){},1619:function(e,t,n){},1620:function(e,t,n){},1621:function(e,t,n){},1622:function(e,t,n){},1623:function(e,t,n){var a=n(696),o=n(274),i=n(400),r=Math.max,s=Math.min;e.exports=function(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var l=c-1;return void 0!==n&&(l=i(n),l=n<0?r(c+l,0):s(l,c-1)),a(e,o(t,3),l,!0)}},1624:function(e,t,n){},1625:function(e,t,n){},1626:function(e,t,n){},1627:function(e,t,n){"use strict";var a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(1)),i=a(n(92)),r=function(e){return o.default.createElement(i.default,Object.assign({width:"14",height:"16",viewBox:"0 0 18 18"},e),o.default.createElement("path",{fill:"#9FADC7",d:"M18 9h-5.5c-1.37 0-2.5 1.12-2.5 2.5 0 1.39 1.12 2.5 2.5 2.5H18v1.997A1.999 1.999 0 0 1 16.005 18H1.995A1.997 1.997 0 0 1 0 15.997V7.003C0 5.897.893 5 1.995 5h14.01C17.107 5 18 5.894 18 7.003V9zM4 4c.872-.374 1.696-.735 2.472-1.083.678-.294 1.35-.588 2.01-.882.663-.294 1.18-.52 1.55-.682.567-.254 1.072-.37 1.516-.35.444.02.765.03 1.126.19.36.16.703.633.857.793L15 4H4zm8.5 9a1.5 1.5 0 1 1 .001-3.001A1.5 1.5 0 0 1 12.5 13z",fillRule:"evenodd"}))};t.default=r},1628:function(e,t,n){"use strict";var a=n(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(1)),i=a(n(92)),r=function(e){return o.default.createElement(i.default,Object.assign({width:"14",height:"16",viewBox:"0 0 18 18"},e),o.default.createElement("path",{fill:"#0C2",d:"M6.276 12.186a.6.6 0 0 1-.523-.31l-.04-.086-1.638-3.622a.301.301 0 0 1 .452-.369L6.46 9.185a.887.887 0 0 0 .8.092L16.35 5.2C14.722 3.265 12.038 2 9 2 4.03 2 0 5.383 0 9.556c0 2.277 1.212 4.326 3.11 5.712a.608.608 0 0 1 .22.685l-.406 1.524c-.02.07-.048.146-.048.22a.3.3 0 0 0 .3.303.335.335 0 0 0 .173-.056l1.97-1.146a.888.888 0 0 1 .742-.1c.92.266 1.91.414 2.938.414 4.97 0 9-3.383 9-7.556a6.573 6.573 0 0 0-1.025-3.5L6.612 12.08l-.066.04a.604.604 0 0 1-.27.064z",fillRule:"evenodd"}))};t.default=r},1629:function(e,t,n){},1630:function(e,t,n){},1631:function(e,t,n){},1632:function(e,t,n){},1651:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(8),i=n(7),r=n(5),s=n(6),c=n(0),l=n(1),d=n.n(l),m=n(9),u=n.n(m),p=n(72),b=n.n(p),h=n(11);n(1394);var f=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(s)))).rootRef=d.a.createRef(),n.unobserve=b.a,n.renderTarget=function(){var e=n.props.item,t=e.content.target,a=t.text,o=t.link,i=e.id,r=e.target,s=e.target,l=(s=void 0===s?{}:s).id,d=s.target,m=void 0===d?{}:d,u=m.type;return r&&"comment"===r.type?n.renderCommentButton(a,{type:u,href:o,byComment:l,target:m,notificationId:i}):Object(c.b)("span",null,o?Object(c.b)("a",{href:o,"data-za-detail-view-id":5109},a):Object(c.b)("span",null,a))},n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.addObserve,n=e.item.attachInfo,a=this.rootRef.current;h.default.setModule(a,{module:"Content"},{attached_info_bytes:n}),this.unobserve=t(a)}},{key:"componentWillUnmount",value:function(){this.unobserve()}},{key:"renderCommentButton",value:function(e,t){var n=this,a=t.href,o=t.byComment,i=t.notificationId;return Object(c.b)("a",{href:"".concat(a).concat(o?"#comment-".concat(o,"?notificationId=").concat(i):""),"data-za-detail-view-id":5109,onClick:function(e){e.preventDefault(),n.props.onCommentsModalOpen(t)}},e)}},{key:"render",value:function(){var e,t=this.props.item,n=t.content,a=n.verb,o=n.actors,i=t.isRead;return Object(c.b)("div",{ref:this.rootRef,className:u()("PushNotifications-item",{"PushNotifications-newItem":!i})},Object(c.b)("span",null,(e=o,Array.isArray(e)||(e=[e]),e.map(function(e,t){return Object(c.b)("span",{className:"PushNotifications-actor",key:t},e.link?Object(c.b)("a",{href:e.link,"data-za-detail-view-id":5109},e.name):Object(c.b)("span",null,e.name))})))," ",a," ",this.renderTarget())}}]),t}(l.Component);t.default=f},1653:function(e,t,n){"use strict";n.r(t);var a,o,i=n(15),r=n(23),s=n(3),c=n(4),l=n(8),d=n(7),m=n(5),u=n(6),p=n(0),b=n(2),h=n.n(b),f=n(1),v=n.n(f),C=n(11),O=n(40),j=n(9),y=n.n(j),g=n(691),k=n(10),w=n(36),N=(n(1601),"oneself"),I="enterprise",R={declare:{title:"发表澄清声明",image:"https://zhstatic.zhihu.com/assets/report/Statement@3x.png",description:(a={},Object(s.a)(a,N,"个人可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的形式显示在投诉内容的上方，点击可跳转至您的声明全文页面"),Object(s.a)(a,I,"企业可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的形式显示在投诉内容的上方，点击可跳转至您的声明全文页面"),a)},trespass:{title:"提交侵权举报",image:"https://zhstatic.zhihu.com/assets/report/Infringement@3x.png",description:Object(p.b)("span",null,"您提交的侵权举报将会根据知乎侵权举报规范进行受理")}},P=(o={},Object(s.a)(o,I,"当您发现知乎上存在涉嫌侵犯您企业合法权益的内容时，您可以先尝试与作者沟通解决，如沟通无效，也可以通过以下方式向知乎提出诉求。"),Object(s.a)(o,N,"当您发现知乎上存在涉嫌侵犯您个人合法权益的内容时，您可以通过以下方式向知乎提出诉求。"),o),S=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){C.default.trackEvent(e,{id:3467,aciton:"Click"})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){C.default.trackCardShow(null,{id:3466})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSubMenuEnter,a=t.onBackClick,o=t.isMobile,i=t.childNodes,r=t.activeNode.reason,s=i.map(function(e){return Object.assign({},R[e.reason],{id:e.id})});return Object(p.b)("section",{className:y()("ReportInfringement",{"ReportInfringement--mobile":o})},Object(p.b)("p",{className:"ReportInfringement-subtitle"},P[r]),Object(p.b)("ul",{className:"ReportInfringement-list"},s.map(function(t){var a=t.image,o=t.title,i=t.description,s=t.id,c=i[r]||i;return Object(p.b)("li",{className:"ReportInfringement-item",key:o,"data-za-module":"Content","data-za-detail-view-path-module_name":o,onClick:function(t){e.handleClick(t.currentTarget),n(s)}},Object(p.b)("img",{className:"ReportInfringement-image",src:a}),Object(p.b)("div",{className:"ReportInfringement-content"},Object(p.b)("h1",{className:"ReportInfringement-itemTitle"},o),Object(p.b)("p",{className:"ReportInfringement-itemDescription"},c)),Object(p.b)(g.a,{className:"ReportInfringement-arrow"}))})),Object(p.b)(w.a,{direction:"horizontal"},Object(p.b)(k.c,{"data-za-module":"Content","data-za-detail-path-view-module_name":"返回",onClick:function(t){e.handleClick(t.currentTarget),a()}},"返回")))}}]),t}(v.a.Component),T=n(46),D=function(e){return"https://www.zhihu.com/account/infringement?".concat(Object(T.stringify)(e))};n(1602);function L(e){var t=e.infringementType;return Object(p.b)("p",{className:"ReportOrgContent"},"若您已注册机构号，可使用",Object(p.b)("span",{className:"ReportOrgContent-highlight"},"机构号"),"declare"===t?"发表澄清声明":"提交侵权举报","，",Object(p.b)("span",{className:"ReportOrgContent-highlight"},"免提交资质材料"),"。")}var F=n(41),x=function(e){return"".concat(window.location.origin,"/appview/account/infringement?").concat(Object(T.stringify)(e))};n(1603);function A(e){var t=e.isIndividualReason,n=e.onBackClick,a=e.urlToken,o=e.type;return Object(p.b)("div",{className:"InfringementReport-wrapper"},Object(p.b)("div",{className:"InfringementReport-title"},"提交侵权举报"),Object(p.b)("div",{className:"InfringementReport-subTitle"},"".concat(t?"个人侵权":"企业侵权")),Object(p.b)("div",{className:"InfringementReport-text"},Object(p.b)("ul",null,Object(p.b)("li",null,"根据"," ",Object(p.b)("a",{href:"https://www.zhihu.com/terms#sec-report",rel:"noopener noreferrer",target:"_blank",className:"InfringementReport-rules"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，并规范填写投诉说明。若您已确认完毕，请继续提交举报信息。"),!t&&Object(p.b)("li",null,Object(p.b)("br",null),"若您已注册机构号，可使用",Object(p.b)("span",null,"机构号"),"提交侵权举报，",Object(p.b)("span",null,"免提交资质材料"),"。"))),Object(p.b)("div",{className:"InfringementReport-buttonGroup"},Object(p.b)(k.c,{className:"InfringementReport-back",onClick:n},"返回"),Object(p.b)(k.c,{className:"InfringementReport-submit",onClick:function(){F.default.dispatch("base/openURL",{url:x({resourceId:a,type:o,reasonType:t?"inflictIndividual":"enterprise",route_simi_to_full:!0,zh_nav_right:"empty"})})}},"继续提交举报")))}n(1604);function B(e){var t=e.infringementType,n=e.isIndividualReason,a=e.onBackClick,o=e.urlToken,i=e.type,r=e.isUseInfringementReport,s="declare"===t;return Object(p.b)("div",null,s?Object(p.b)("div",{className:"ReportInfringementMobile"},Object(p.b)("p",{className:"ReportInfringementMobile-text"},"1."," ","".concat(n?"个人":"企业","可以对站内关于自身的不实描述内容发表澄清声明，声明通过审核后，将会以标记的方式形式显示在投诉内容的上方，点击可跳转至您的声明全文。")),Object(p.b)("p",{className:"ReportInfringementMobile-text"},"2. 根据",Object(p.b)("a",{className:"ReportInfringementMobile-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料， 以发表澄清声明。 若您已确认完毕，",Object(p.b)("span",{className:"ReportInfringementMobile-bold"},"请到桌面版网页进行诉求提交。")),!n&&Object(p.b)("p",{className:"ReportInfringementMobile-text"},"若您已注册机构号，可使用机构号\n              '发表澄清声明' ，免提交资质材料。"),Object(p.b)("img",{className:"ReportInfringementMobile-img",src:"https://zhstatic.zhihu.com/report/app_report.png"}),Object(p.b)(k.c,{color:k.a.Blue,preset:k.b.Primary,onClick:a,className:"ReportInfringementMobile-button"},"我知道了")):r?Object(p.b)(A,{infringementType:t,isIndividualReason:n,onBackClick:a,urlToken:o,type:i}):Object(p.b)("div",{className:"ReportInfringementMobile"},Object(p.b)("p",{className:"ReportInfringementMobile-text"},"1. 您提交的侵权举报将会根据知乎侵权举报规范进行受理。"),Object(p.b)("p",{className:"ReportInfringementMobile-text"},"2. 根据",Object(p.b)("a",{className:"ReportInfringementMobile-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank",rel:"noopener noreferrer"},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料， 并规范填写投诉说明。 若您已确认完毕，",Object(p.b)("span",{className:"ReportInfringementMobile-bold"},"请到桌面版网页进行诉求提交。")),!n&&Object(p.b)("p",{className:"ReportInfringementMobile-text"},"若您已注册机构号，可使用机构号".concat(s?"发表澄清声明":"提交侵权举报","，免提交资质材料。")),Object(p.b)("img",{className:"ReportInfringementMobile-img",src:"https://zhstatic.zhihu.com/report/app_report.png"}),Object(p.b)(k.c,{color:k.a.Blue,preset:k.b.Primary,onClick:a,className:"ReportInfringementMobile-button"},"我知道了")))}n(1605);var M=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){C.default.trackEvent(null,{id:3469,action:"Click"},{button:{text:e}})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){C.default.trackCardShow(null,{id:3468})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,a=t.urlToken,o=t.type,i=t.isMobile,r=t.parentNode,s=t.isUseInfringementReport,c=!("enterprise"===r.reason);return i?Object(p.b)(B,{isIndividualReason:c,infringementType:"declare",onBackClick:n,type:o,urlToken:a,isUseInfringementReport:s}):Object(p.b)("section",{className:"ReportDeclare"},Object(p.b)("div",{className:"ReportDeclare-description"},"当您发现知乎上有关于您",c?"个人":"企业","的侵权内容时，您可通过此方式发表澄清声明。",Object(p.b)("br",null),Object(p.b)("br",null),"申请发表澄清声明的流程如下：",Object(p.b)("ul",null,Object(p.b)("li",null,"1. 在站内写一篇",Object(p.b)("a",{href:"https://zhuanlan.zhihu.com/write",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("澄清声明文章")}},"澄清声明文章"),"并发布。",Object(p.b)("a",{href:"https://zhstatic.zhihu.com/assets/report/template-v2.png",target:"_blank",rel:"noopener noreferrer",onClick:function(){return e.handleClick("查看模版")}},"查看模版"),Object(p.b)("br",null)),Object(p.b)("li",null,"2.返回此页面继续发表声明，您需按照提示提供完整、有效的证明材料。",Object(p.b)("br",null)),Object(p.b)("li",null,"3.审核通过后，侵权纠纷内容上会关联展示您的澄清声明，点击可跳转至您的声明全文。")),!c&&Object(p.b)(L,{infringementType:"declare"})),Object(p.b)(w.a,{direction:"horizontal"},Object(p.b)(k.c,{onClick:n},"返回"),Object(p.b)(k.c,{onClick:function(){return e.handleClick("继续发表声明")},component:"a",href:D({infringementType:"declare",resourceId:a,type:o,reasonType:c?"inflictIndividual":"enterprise"}),className:"ReportDeclare-continue",color:k.a.Blue,preset:k.b.Primary},"继续发表声明")))}}]),t}(v.a.Component),E=(n(1606),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e){C.default.trackEvent(null,{id:3510,aciton:"Click"},{button:{text:e}})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){C.default.trackCardShow(null,{id:3509})}},{key:"render",value:function(){var e=this,t=this.props,n=t.onBackClick,a=t.urlToken,o=t.type,i=t.isMobile,r=t.parentNode,s=t.isUseInfringementReport,c=!("enterprise"===r.reason);return i?Object(p.b)(B,{isIndividualReason:c,infringementType:"trespass",onBackClick:n,urlToken:a,type:o,isUseInfringementReport:s}):Object(p.b)("section",{className:"ReportTrespass"},Object(p.b)("p",{className:"ReportTrespass-description"},"根据",Object(p.b)("a",{href:"https://www.zhihu.com/terms#sec-report",onClick:function(){e.handleClick("知乎侵权举报规范")}},"知乎侵权举报规范"),"，您需按照提示提供完整、有效的证明材料，并规范填写投诉说明。若您已确认完毕，请继续提交举报信息。"),!c&&Object(p.b)(L,{infringementType:"trespass"}),Object(p.b)(w.a,{direction:"horizontal"},Object(p.b)(k.c,{onClick:function(){e.handleClick("返回"),n()}},"返回"),Object(p.b)(k.c,{onClick:function(){e.handleClick("继续提交举报")},component:"a",href:D({resourceId:a,type:o,reasonType:c?"inflictIndividual":"enterprise"}),className:"ReportTrespass-continue",color:k.a.Blue,preset:k.b.Primary},"继续提交举报")))}}]),t}(v.a.Component)),q=[{id:0,text:"举报",childIds:[1,2,39,30001,4,5,21,7,8,9]},{id:1,text:"低质问题",types:["question","drama_statement"],childIds:[23,33,34,35,27,22]},{id:2,text:"垃圾广告信息",reason:"spam",copywriter:{title:"举报说明",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"未经平台允许，知乎禁止使用帐号的任何功能，发布含有产品售卖信息、牟利性外链及违规推广等信息或引导用户至第三方平台进行交易。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。",url:"https://zhuanlan.zhihu.com/p/96916639"},{id:30001,reason:"abuse",text:"辱骂、人身攻击等不友善行为",types:["question","answer","article","pin","comment","zvideo","drama_bullet","favlist","book_review","discussion_review"],copywriter:{title:"举报说明",placeholder:"举报详细说明",isRequired:["zvideo","drama_bullet","book_review","discussion_review"]},disabled:!0,des:"知乎鼓励友善的讨论。请在举报时提供对人产生辱骂、人身攻击或冒犯的相关内容段落或其他信息。感谢你与我们共同维护知乎的讨论氛围。",url:"https://www.zhihu.com/question/20239684"},{id:4,text:"有害信息",childIds:[19,30,26,18,28]},{id:5,text:"涉嫌侵权",childIds:[20,29,12],types:["question","drama_statement","answer","comment","drama_bullet","article","pin","book_review","zvideo"],reason:"infringement",disabled:!0},{id:7,text:"其他",reason:"old",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,types:["message","book_review","discussion_review","drama_statement","drama_bullet"]},{id:8,reason:"direction",shouldShow:function(e){return e.isColumnArticle}},{id:9,reason:"tipjar",shouldShow:function(e){return e.isTipjarEnabled}},{id:12,reason:"enterprise",disabled:!0,customComponent:S,childIds:[48,49]},{id:17,reason:"spam"},{id:18,reason:"illegality",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0},{id:19,reason:"politics"},{id:20,reason:"repost",copywriter:{title:"不规范转载说明",placeholder:"原文链接或补充说明",maxLength:1e3},types:["answer","article","pin","book_review"],disabled:!0,des:"知乎鼓励对引用内容进行清晰的出处标注。请在举报时提供违规引用的内容链接或出处，感谢你与我们共同保护原创版权。",url:"https://www.zhihu.com/question/20258015/answer/72942383"},{id:21,reason:"temptation",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,types:["answer","comment","drama_bullet","article","column","zvideo"],des:"知乎禁止通过各种方式比如利益诱导（赞同、反对、分享行为后对用户有奖励）、威胁逼迫等形式干预用户在知乎站内的赞同、关注等，影响内容在站内正常流通。请在举报时简述理由，感谢你与我们共同维护社区氛围。",url:"https://zhuanlan.zhihu.com/p/96927876"},{id:22,reason:"personal"},{id:23,reason:"ambiguity"},{id:26,reason:"suicide",types:["question","drama_statement","answer","article","pin","book_review","comment","drama_bullet","zvideo"]},{id:27,reason:"medicine"},{id:28,reason:"superstition"},{id:29,reason:"oneself",disabled:!0,customComponent:S,childIds:[46,47]},{id:30,reason:"porn"},{id:33,reason:"subjective",copywriter:{title:"包含主观判断",placeholder:"举报详细说明",isRequired:["drama_statement"]},des:"问题中包含提问者无根据或非常主观甚至包含争议的见解、结论或推测。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。",url:"https://www.zhihu.com/question/19806261"},{id:34,reason:"rumour",copywriter:{title:"缺乏可信来源",placeholder:"举报详细说明",isRequired:["drama_statement"]},des:"未提供可靠的信息来源，或提问前提属于谣言 / 存在事实错误。请在举报时简述理由或补充来源，感谢你与我们共同维护社区的良好氛围。",url:"https://www.zhihu.com/question/19806261"},{id:35,reason:"provoke",copywriter:{title:"引战争议等非真实问题",placeholder:"举报详细说明",isRequired:["drama_statement"]},des:"刻意引起群体或个人之间的对立、冲突、激化矛盾的问题。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。",url:"https://www.zhihu.com/question/19806261"},{id:39,text:"不实信息",types:["answer","comment","drama_bullet","article","pin","book_review","zvideo"],childIds:[42,43,44,45]},{id:40,reason:"abuse"},{id:41,reason:"unfriendly",copywriter:{title:"不规范转载说明",placeholder:"原文链接或补充说明",maxLength:1e3},disabled:!0,des:"知乎鼓励对引用内容进行清晰的出处标注。请在举报时提供违规引用的内容链接或出处，感谢你与我们共同保护原创版权。",url:"https://www.zhihu.com/question/20258015/answer/72942383"},{id:42,reason:"untruth_science",text:"科学类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,des:"知乎鼓励专业的回答，请在举报时提供内容中与当前学术共识或权威研究结论相左的错误或不准确部分，或通过权威资讯指出其中错误，感谢你的支持。",url:"https://zhuanlan.zhihu.com/p/96929600"},{id:43,reason:"untruth_rumor",text:"社会谣言类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,des:"为保证站内信息传播的客观真实，知乎会持续对社会谣言类不实信息进行处理。请在举报时提供政府机构、有关机构、权威媒体发布的辟谣信息或其他佐证，知乎将会核实处理，感谢你的支持。"},{id:44,reason:"untruth_fake_profile",text:"编造经历类不实信息",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,types:["answer","drama_bullet","pin","book_review"],des:"知乎禁止对标榜真实经历的内容进行恶意夸大或过分虚构的行为。请在举报时提供被举报内容中编造经历的佐证，如事实错误、前后矛盾等相关内容段落或其他详细信息。感谢你与我们共同维护知乎真实的内容环境。"},{id:45,text:"诽谤等侵权信息",childIds:[20,29,12],types:["answer","comment","drama_bullet","article","pin","book_review"]},{id:46,customComponent:M,text:"发表澄清声明",reason:"declare",types:["answer","article","pin"],subtitle:"个人侵权"},{id:47,customComponent:E,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:48,customComponent:M,text:"发表澄清声明",reason:"declare",types:["answer","article","pin"],subtitle:"企业侵权"},{id:49,customComponent:E,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],z=[{id:0,text:"举报",childIds:[1,2,3,4]},{id:1,text:"垃圾广告信息",reason:"spam",copywriter:{title:"垃圾广告信息",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"未经平台允许，知乎禁止使用帐号的任何功能发布含有产品售卖信息、牟利性外链及违规推广等信息或引导用户至第三方平台进行交易。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。"},{id:2,text:"辱骂、人身攻击等不友善行为",reason:"unkind",copywriter:{title:"辱骂、人身攻击等不友善行为",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"知乎鼓励友善的讨论。请在举报时提供对人产生辱骂、人身攻击或冒犯的相关内容段落或其他信息。感谢你与我们共同维护知乎的讨论氛围。"},{id:3,text:"有害信息",reason:"imitation",disabled:!0,childIds:[19,30,26,18,28]},{id:19,reason:"politics"},{id:28,reason:"superstition"},{id:30,reason:"porn"},{id:26,reason:"suicide",types:["question","drama_statement","answer","article","pin","book_review","comment","drama_bullet","zvideo"]},{id:18,reason:"illegality",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0}],_=[{id:0,text:"举报",childIds:[1,2,3]},{id:1,reason:"abuse",copywriter:{title:"举报说明",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"知乎鼓励友善的讨论。请在举报时提供对人产生辱骂、人身攻击或冒犯的相关内容段落或其他信息。感谢你与我们共同维护知乎的讨论氛围。",url:"https://www.zhihu.com/question/20239684"},{id:2,reason:"harassment",copywriter:{title:"举报说明",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"存在冒犯、威胁、性骚扰等骚扰行为。"},{id:3,reason:"spam",copywriter:{title:"举报说明",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"未经平台允许，知乎禁止使用帐号的任何功能发布含有产品售卖信息、牟利性外链及违规推广等信息或引导用户至第三方平台进行交易。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。",url:"https://zhuanlan.zhihu.com/p/96916639"}],U=[{id:0,text:"举报",childIds:[1,4,6,7]},{id:1,text:"冒充我或他人",childIds:[8,9],reason:"fake",disabled:!0},{id:4,reason:"spam",text:"垃圾广告帐号",copywriter:{title:"垃圾广告帐号",placeholder:"举报详细说明",isRequired:!1},disabled:!0,des:"未经平台允许，知乎禁止使用帐号的任何功能发布含有产品售卖信息、牟利性外链及违规推广等信息或引导用户至第三方平台进行交易。请在举报时简述理由，感谢你与我们共同维护社区的良好氛围。",url:"https://zhuanlan.zhihu.com/p/96916639"},{id:6,reason:"profile",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0,des:"用户名、头像、封面图、个人形象词包含联系方式；或高风险行业帐号的用户信息中包含联系方式；或用户名易与帐号使用状态、使用者身份产生混淆和误解。请在举报时简述原因，感谢你的支持。",url:"https://www.zhihu.com/question/19551824"},{id:8,text:"冒充我",subtitle:"请选择举报理由",reason:"oneself",disabled:!0,childIds:[10,11]},{id:9,reason:"impersonate",copywriter:{title:"举报说明",placeholder:"举报详细说明"},text:"冒充他人",disabled:!0},{id:10,reason:"oneself",disabled:!0,isRequired:!0,customComponent:S,childIds:[12]},{id:11,reason:"enterprise",disabled:!0,isRequired:!0,customComponent:S,childIds:[13]},{id:12,isRequired:!0,customComponent:E,text:"提交侵权举报",reason:"trespass",subtitle:"个人侵权"},{id:13,isRequired:!0,customComponent:E,text:"提交侵权举报",reason:"trespass",subtitle:"企业侵权"}],V=[{id:0,text:"举报",childIds:[2,3,4,5,14,15,16,17,18,700]},{id:2,reason:"abuse",text:"骚扰/辱骂/歧视等不友善行为"},{id:3,reason:"illegality",text:"发过违反法律法规的内容"},{id:4,reason:"spam",text:"垃圾广告帐号"},{id:5,reason:"politics",text:"发过政治敏感内容"},{id:14,reason:"minor"},{id:15,reason:"porn"},{id:16,reason:"uncivilized_behavior"},{id:17,reason:"suicide",text:"疑似自杀或自残"},{id:18,reason:"superstition"},{id:700,reason:"old",text:"其他",copywriter:{title:"举报说明",placeholder:"举报详细说明"},disabled:!0}],W=[{id:0,text:"举报",childIds:[1]},{id:1,reason:"profile"}],K=n(14),H=n(33),G=n(58),Z=n.n(G),J=n(603),Q=n(293),$=n(1364),X=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this))).handleClick=e.handleClick.bind(Object(H.default)(e)),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.id,n=e.reason,a=e.disabled,o=e.onSubMenuEnter,i=e.onItemSelect,r=e.copywriter;n&&void 0===(null==r?void 0:r.isRequired)&&!a?i(t):o(t)}},{key:"render",value:function(){var e=this.props,t=e.reason,n=e.text,a=e.disabled,o=e.isSelected,i=e.id,r=e.copywriter,s=n||Q.b[t];return Boolean(t&&!r&&!a)?Object(p.b)("label",{className:"ReportMenu-item",htmlFor:t},Object(p.b)("div",{className:"ReportMenu-itemValue needsclick"},s),Object(p.b)("input",{className:"ReportMenu-itemCheck",type:"radio",name:"report",value:i,id:t,checked:o,onChange:this.handleClick}),Object(p.b)($.a,{size:18,className:"ReportMenu-itemCheckIcon",name:"checkRound"})):Object(p.b)("button",{className:"ReportMenu-item",onClick:this.handleClick},Object(p.b)("span",{className:"ReportMenu-itemValue"},s),Object(p.b)(g.a,{size:18}))}}]),t}(f.Component);X.propTypes={id:h.a.number.isRequired,reason:h.a.string,text:h.a.string,disabled:h.a.bool,isSelected:h.a.bool,onSubMenuEnter:h.a.func.isRequired,onItemSelect:h.a.func.isRequired};var Y=n(54),ee=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.copywriter.placeholder,n=e.onDetailInput,a=e.errorText,o=e.checkCustomReasonContent,i=e.isCustomReasonRequired;return Object(p.b)("div",{className:"ReportMenu-inner"},Object(p.b)(Y.a,{multiline:!0,grey:!0,rows:5,className:"ReportMenu-textarea",placeholder:"".concat(t,i?"（必填）":"（选填）"),onChange:function(e){return n(e.target.value)},onBlur:o}),Object(p.b)("div",{className:"ReportMenu-errorText"},a))}}]),t}(f.Component);ee.propTypes={onDetailInput:h.a.func.isRequired,copywriter:h.a.object,errorText:h.a.string};n(1607);var te=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.checked,n=e.onChange,a=e.name,o=e.text,i=e.desc,r=a||o;return Object(p.b)("div",null,Object(p.b)("label",{className:"ReportOption-check",htmlFor:r},Object(p.b)("input",{type:"checkbox",name:r,checked:t,onChange:n}),Object(p.b)("span",null,"同时",o)),i&&Object(p.b)("div",{className:"ReportOption-desc"},i))}}]),t}(f.Component),ne=function(e,t){var n=t&&t.maxLength;return e.length>(n||150)?{isLegal:!1,errorReason:n?"".concat(t.title||"举报说明","不能超过 ").concat(n," 字"):Q.a.contentTooLong}:/[\u4e00-\u9fa5a-zA-Z0-9]/.test(e)?{isLegal:!0,errorReason:""}:{isLegal:!1,errorReason:Q.a.contentIllegal}},ae=(n(1608),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={blockChecked:!1,commentChecked:!1,activeId:0,parentId:null,selectedId:null,errorText:"",isMobile:!1,isSubmiting:!1,isSubmited:!1,path:[]},n.menuItems={},n.getReportText=function(e){if(!e)return"";var t=n.props.nodes[e];return t&&(t.text||Q.b[t.reason])||""},n.getReportLevel=function(){return"第 ".concat(n.state.path.length+1," 级")},n.handleItemSelect=function(e){var t=n.selectedId===e?null:e;n.setState({selectedId:t});var a=n.props,o=a.zaEnabled,i=a.type;t&&o&&C.default.trackEvent(null,{action:"Select",element:"Menu",id:2883,name:n.getReportLevel()},{button:{text:n.getReportText(e)},report:{id:e,type:i}})},n.handleSubMenuEnter=function(e){n.setState(function(t){var n=t.activeId,a=t.path;return{activeId:e,parentId:n,selectedId:null,path:a.concat([e])}});var t=n.props,a=t.zaEnabled,o=t.type;a&&C.default.trackEvent(null,{action:"Expand",element:"Menu",id:2883,name:n.getReportLevel()},{button:{text:n.getReportText(e)},report:{id:e,type:o}})},n.hasEffectOfDeleteComment=function(){var e=n.props.nodes,t=n.state,a=t.parentId,o=t.activeId,i=e[a||o];return Boolean(i&&i.effects)&&i.effects.includes("delete_comment")},n.handleDetailInput=function(e){n.setState({customReason:e,errorText:""})},n.handleBackClick=function(){var e=n.props.nodes,t=n.state,a=t.parentId,o=t.path,i=Object.keys(e).find(function(t){var n=e[t].childIds;return n&&n.includes(a)});n.setState({activeId:a,parentId:i&&Number(i),selectedId:null,hasWarning:!1,customReason:"",errorText:"",path:o.slice(0,-1)});var r=n.props,s=r.zaEnabled,c=r.type;s&&C.default.trackEvent(null,{action:"Back",element:"Button",id:2884,name:n.getReportLevel()},{report:{id:n.state.activeId,type:c}})},n.handleSubmit=function(){var e=n.state,t=e.selectedId,a=e.customReason,o=e.activeId;if(n.isSubmitEnabled()&&n.checkCustomReasonContent()){var i=n.props,r=i.nodes,s=i.onSubmit,c=i.onDeleteComment,l=r[t||o],d=l.reason,m=l.id;n.setState({isSubmiting:!0});var u=s({reason:d,customReason:a});u&&u.then?u.then(n.submitEnd):n.submitEnd();var p=n.props,b=p.zaEnabled,h=p.type;if(b){var f=c&&n.hasEffectOfDeleteComment();C.default.trackEvent(null,{id:2885,name:n.getReportLevel(),action:"Click"},{report:{type:h},button:{text:n.getReportText(m)}}),C.default.trackEvent(Object(H.default)(n),Object.assign({action:"Report",element:"Button"},f&&{id:3039,name:d}),Object.assign({report:{id:m,type:h}},f&&{button:{text:n.state.commentChecked?"举报并删除":"仅举报"}}))}}},n.submitEnd=function(e){n.setState({isSubmiting:!1,isSubmited:!0});var t=n.state,a=t.blockChecked,o=t.commentChecked,i=n.props,r=i.onBlockUser,s=i.onDeleteComment,c=i.onEnd;Promise.all([a&&r&&r(),o&&s&&s()].map(function(e){return Promise.resolve(e).catch(function(e){return e})})).then(function(t){var n=Object(K.a)(t,2),a=n[0],o=n[1];c&&c({result:e,blockUserResult:a,commentDeleteResult:o})})},n.checkCustomReasonContent=function(){var e=n.state,t=e.activeId,a=e.customReason,o=n.props.nodes[t].copywriter;if(Boolean(o)&&a){var i=ne(a,o),r=i.isLegal,s=i.errorReason;if(!r)return n.setState({errorText:s}),!1}return!0},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.type,t=Z()(navigator.userAgent);this.setState({isMobile:t.Mobile}),C.default.trackCardShow(null,{id:2890},{button:{text:e}})}},{key:"componentWillUpdate",value:function(e,t){var n=this.state.activeId,a=t.activeId,o=this.props,i=o.nodes,r=o.onContentChange;if(a!==n){var s=i[a],c=s.reason,l=s.text,d=s.childIds,m=s.copywriter,u=s.subtitle;r(l||Q.b[c],u||m&&m.title||(d?void 0:""))}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.zaEnabled,n=e.type,a=this.state.isSubmited;t&&!a&&C.default.trackEvent(null,{id:4328,action:"Close",name:this.getReportLevel()},{report:{type:n}})}},{key:"isSubmitEnabled",value:function(){var e=this.state,t=e.selectedId,n=e.activeId,a=e.customReason;if(t)return!0;var o=this.props,i=o.nodes,r=o.type,s=i[n].copywriter;if(!s)return!1;var c=s.isRequired,l=void 0===c||c,d=Array.isArray(l)?l.includes(r):l;return Boolean(!d||a)}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,a=t.options,o=t.isUseInfringementReport,s=t.type,c=Object(r.a)(t,["nodes","options","isUseInfringementReport","type"]),l=this.state,d=l.activeId,m=l.parentId,u=l.selectedId,b=l.errorText,h=l.isMobile,f=n[d],C=f.childIds,O=f.copywriter,j=void 0!==O&&O,g=f.customComponent,N=f.des,I=f.url,R=j.isRequired,P=void 0===R||R,S=C&&C.map(function(e){return n[e]}).filter(function(e){return e&&(!e.shouldShow||e.shouldShow(c))}),T=!0===P||Array.isArray(P)&&P.includes(s);if(void 0!==g)return Object(p.b)(g,Object(i.default)({onBackClick:this.handleBackClick,onItemSelect:this.handleItemSelect,onSubMenuEnter:this.handleSubMenuEnter},this.props,this.state,{activeNode:f,parentNode:n[m],childNodes:S,isUseInfringementReport:o}));var D=Boolean(C),L=Boolean(j),F=D&&Object(p.b)("div",{className:"ReportMenu-inner ReportMenu-options"},S.map(function(t){return Object(p.b)(X,Object(i.default)({ref:function(n){e.menuItems[t.id]=n},key:t.id},t,{isSelected:u===t.id,onSubMenuEnter:e.handleSubMenuEnter,onItemSelect:e.handleItemSelect,type:s}))})," ")||L&&Object(p.b)(ee,{onDetailInput:this.handleDetailInput,type:s,copywriter:j,errorText:b,checkCustomReasonContent:this.checkCustomReasonContent,isCustomReasonRequired:T}),x=D&&c.talkerToken&&Object(p.b)(te,{checked:this.state.blockChecked,text:"将此人屏蔽",onChange:function(t){return e.setState({blockChecked:t.target.checked})}}),A=n[m||d],B=c.onDeleteComment&&this.hasEffectOfDeleteComment()&&Object(p.b)(te,{checked:this.state.commentChecked,desc:A&&"社区鼓励举报".concat(A.text,"，同时可以直接删除该评论，删除操作并不影响对违规内容和违规用户的处理。"),onChange:function(t){return e.setState({commentChecked:t.target.checked})},text:"删除该评论"}),M=this.props.isSubmiting;return Object(p.b)("div",{className:y()("ReportMenu",{"ReportMenu-mobile":h})},F,(x||B)&&Object(p.b)("div",null,x,B,a),Object(p.b)(w.a,{direction:"horizontal"},"number"==typeof m&&Object(p.b)(k.c,{onClick:this.handleBackClick}," 返回 "),(D||L)&&Object(p.b)(k.c,{className:"ReportMenu-button",disabled:M||!this.isSubmitEnabled(),onClick:this.handleSubmit,color:"blue",preset:"primary"},"举报")),L&&N&&Object(p.b)("div",{className:"ReportMenu-des"},N,I&&Object(p.b)(v.a.Fragment,null,"点击",Object(p.b)(J.a,{className:"ReportMenu-deslink",href:I},"了解更多社区规范"),"。")))}}]),t}(f.Component));ae.propTypes={nodes:h.a.object.isRequired,onContentChange:h.a.func.isRequired,onSubmit:h.a.func.isRequired,onEnd:h.a.func,onBlockUser:h.a.func,onDeleteComment:h.a.func,isColumnArticle:h.a.bool,isTipjarEnabled:h.a.bool,isUseInfringementReport:h.a.bool},ae.defaultProps={isUseInfringementReport:!1};var oe=ae,ie=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).filterNodes=function(e,t,n){var a=e.filter(function(e){return!!e.isRequired||(-1!=["infringement","repost","oneself","enterprise","fake"].indexOf(e.reason)||0===e.id||("question"!==t||-1==["closed","suggested","evaluated","locked"].indexOf(n)||0===e.id)&&("member"!==t||-1==["ban","hang"].indexOf(n)||"profile"===e.reason))});return 1===a.length&&0===a[0].id&&(a=[]),a},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.type,a=t.status,o=Object(r.a)(t,["type","status"]);return e="message"===n?_:["member","club_mask"].includes(n)?U:["drama","drama_connect_member"].includes(n)?V:"theater"===n?W:"favlist"===n||"collection"===n?z:q.filter(function(e){return!e.types||e.types.includes(n)}),e=this.filterNodes(e,n,a),Object(p.b)(oe,Object(i.default)({nodes:e.reduce(function(e,t){return Object.assign({},e,Object(s.a)({},t.id,t))},{})},o,{type:n}))}}]),t}(f.Component);ie.propTypes={type:h.a.string.isRequired};var re=n(1435),se=function(e){return"article"===e?"Post":"book_review"===e?"BookReview":"".concat(e.slice(0,1).toUpperCase()).concat(e.slice(1))},ce=n(135),le="请选择举报理由",de="举报",me=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).state={title:void 0!==n.props.title?n.props.title:de,subtitle:void 0!==n.props.subtitle?n.props.subtitle:le},n.handleSubmit=function(e){var t=e.reason,a=e.customReason,o=n.props,i=o.urlToken,r=o.type;return n.props.doReport(i,r,t,a)},n.handleContentChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le;n.setState({title:e,subtitle:t})},n.handleClose=function(){n.props.zaEnabled&&C.default.trackEvent(n.container,{action:"Ok"},{button:{text:"知道了"}}),n.props.onClose()},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){if(!e.shown&&this.props.shown){var t=this.props,n=t.type,a=t.id;C.default.setModule(this.container,{module:"ReportDialog"},{card:{card_type:"Content",content:Object(s.a)({type:se(n)},"comment"===n?"id":"token",String(a))}})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,a=t.onClose,o=Object(r.a)(t,["shown","onClose"]),s=this.state,c=s.title,l=s.subtitle,d=Object(re.a)(o,Object.keys(O.b.propTypes)),m=d.selectedProps,u=d.dropedProps;return Object(p.b)(O.b,Object(i.default)({title:c,subtitle:l,onClose:this.handleClose,className:"ReportModal"},m),n&&Object(p.b)(ie,Object(i.default)({ref:function(t){e.container=t},onSubmit:this.handleSubmit,onEnd:a,onContentChange:this.handleContentChange},u)))}}]),t}(f.Component);me.propTypes={onClose:h.a.func.isRequired,type:h.a.oneOf(ce.a).isRequired,shown:h.a.bool.isRequired,isColumnArticle:h.a.bool,isTipjarEnabled:h.a.bool,onBlockUser:h.a.func,onDeleteComment:h.a.func,doReport:h.a.func.isRequired,zaEnabled:h.a.bool},me.defaultTypes={zaEnabled:!1},n.d(t,"ReportModal",function(){return me})},1655:function(e,t,n){"use strict";n.r(t);var a=n(15),o=n(14),i=n(0),r=n(2),s=n.n(r),c=n(1),l=n(40),d=n(1435),m=function(e,t,n){return n&&void 0!==t&&(e||!t)},u=(n(252),n(10)),p=n(36),b=n(9),h=n.n(b),f=n(54),v=n(343),C=function(e){var t,n=e.onBack,a=e.onSubmit,r=e.authRequired,s=e.isActive,l=e.editItem,d=void 0===l?{}:l,b=e.isDefaultPage,C="edit"===e.currentPage,O=Object(c.useState)(null===(t=d.isPublic)||void 0===t||t),j=Object(o.a)(O,2),y=j[0],g=j[1],k=Object(c.useState)(d.title||""),w=Object(o.a)(k,2),N=w[0],I=w[1],R=Object(c.useState)(d.description||""),P=Object(o.a)(R,2),S=P[0],T=P[1],D=!N||N.length>20||S.length>60,L=C&&!0===d.isPublic&&d.followerCount>0;return Object(i.b)("form",{className:"Favlists-content",onSubmit:function(e){if(e.preventDefault(),N){var t={title:N,description:S,isPublic:y};m(y,s,r)?r(a)(t):(a(t),n())}}},Object(i.b)("div",{className:"Favlists-addItems"},Object(i.b)("div",{className:"Favlists-addItem"},Object(i.b)(f.a,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(e){I(e.target.value)},value:N}),Object(i.b)("div",{className:"Favlists-inputTips"},Object(i.b)(v.a,{name:"收藏标题",current:N?N.length:0,max:20}))),Object(i.b)("div",{className:"Favlists-addItem"},Object(i.b)(f.a,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(e){T(e.target.value)},rows:5,value:S}),Object(i.b)("div",{className:"Favlists-inputTips"},Object(i.b)(v.a,{name:"收藏描述",current:S?S.length:0,max:60}))),Object(i.b)("div",{className:"Favlists-addItem"},Object(i.b)("label",{className:"Favlists-privacyOption"},Object(i.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:y,onChange:function(){return g(!0)}}),Object(i.b)("span",null,"公开"),Object(i.b)("span",{className:"Favlists-privacyOptionTips"},"有其他人关注此收藏夹时不可设置为私密")),Object(i.b)("label",{className:h()("Favlists-privacyOption",{"Favlists-privacyOption--privacyDisable":L})},Object(i.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!y,onChange:function(){return g(!1)},disabled:L}),Object(i.b)("span",null,"私密"),Object(i.b)("span",{className:"Favlists-privacyOptionTips"},L?"当前有人在关注此收藏夹，无法设为隐私":"只有你自己可以查看这个收藏夹")))),Object(i.b)(p.a,{direction:"horizontal",className:""},n&&Object(i.b)(u.c,{onClick:n},b?"取消":"返回"),Object(i.b)(u.c,{color:"blue",preset:"primary",type:"submit",disabled:D},b?"确认":"确认创建")))};C.propTypes={onSubmit:s.a.func.isRequired,onBack:s.a.func,authRequired:s.a.func,isActive:s.a.bool,editItem:s.a.shape({type:s.a.oneOf(["collection"])}),currentPage:s.a.oneOf(["edit","add"]),isDefaultPage:s.a.bool};var O=C,j=(n(1599),n(4)),y=n(8),g=n(7),k=n(5),w=n(6),N=n(56),I=n(202),R=n(11),P=n(1376),S=function(e){function t(){var e,n;Object(j.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(g.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).handleChange=function(){var e=n.props;(0,e.onChange)(e.id,n.props.checked)},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,n=e.id;t&&R.default.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(n)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,n=e.title,o=e.isPublic,r=e.checked,s=void 0!==r&&r?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return Object(i.b)("div",{className:"Favlists-item"},Object(i.b)("div",{className:"Favlists-itemInner"},Object(i.b)("div",{className:"Favlists-itemName"},Object(i.b)("span",{className:"Favlists-itemNameText"},n),!1===o&&Object(i.b)("span",{className:"Favlists-itemIcon"},Object(i.b)(P.a,{size:16}))),Object(i.b)("div",{className:"Favlists-itemContent"},t," 条内容")),Object(i.b)(u.c,Object(a.default)({},s,{className:"Favlists-updateButton",onClick:this.handleChange})))}}]),t}(c.Component),T=function(e){function t(){var e,n;Object(j.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(g.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).items={},n.handleFavlistItemChange=function(e,t){R.default.trackEvent(n.items[e],{action:t?"UnCollect":"Collect",element:"Button",is_intent:!1}),n.props.onUpdate(e,t)},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.relations,o=t.items,r=t.isFetching,s=t.isDrained,c=t.onAdd,l=t.onLoad;return Object(i.b)("div",{className:"Favlists-content"},Object(i.b)(N.b,{isLocal:!0,isLoading:r,isDrained:s,onLoad:l,placeholder:Object(i.b)(I.a,{title:!0}),getContainer:function(e){return e},className:"Favlists-items"},o.map(function(t){return Object(i.b)(S,Object(a.default)({key:t.id,onChange:e.handleFavlistItemChange,checked:n[t.id]},t,{ref:function(n){e.items[t.id]=n}}))})),!o.length&&r||Object(i.b)("div",{className:"Favlists-actions"},Object(i.b)(u.c,{className:"Favlists-addButton",onClick:c,preset:"primary",color:"blue"},"创建收藏夹")))}}]),t}(c.Component);T.propTypes={isFetching:s.a.bool,relations:s.a.object,onUpdate:s.a.func.isRequired,onAdd:s.a.func.isRequired,onLoad:s.a.func.isRequired,items:s.a.array.isRequired,isDrained:s.a.bool,authRequired:s.a.func};var D=T,L=Object(c.forwardRef)(function(e,t){var n=e.currentPage,a=e.items,o=e.isFetching,r=e.isDrained,s=e.relations,c=e.handleUpdateFavList,l=e.onLoad,d=e.zaEnabled,m=e.handleAdd,b=e.handleCloseModal,h=e.onFavlistAdd,f=e.authRequired,v=e.isUserActive,C=e.defaultStatus,j=e.handleBack,y=e.hasFavlists,g=e.editItem,k=void 0===g?{}:g,w=e.onUpdateFavContent;if("list"===n)return y?Object(i.b)(D,{ref:t,items:a,isFetching:o,isDrained:r,relations:s,onAdd:m,onUpdate:c,onLoad:l,zaEnabled:d}):Object(i.b)(p.a,null,Object(i.b)(u.c,{preset:"primary",color:"blue",onClick:m},"创建收藏夹"),Object(i.b)(u.c,{onClick:b},"取消"));if(["add","edit"].includes(n)){var N=C===n;return Object(i.b)(O,{onSubmit:"add"===n?h:w,isActive:v,onBack:N?b:j,authRequired:f,editItem:k,currentPage:n,isDefaultPage:N})}return null});L.propTypes={currentPage:s.a.oneOf(["list","add","edit"]).isRequired,items:s.a.arrayOf(s.a.shape({type:s.a.oneOf(["collection"])})),isFetching:s.a.bool,isDrained:s.a.bool,relations:s.a.object,handleUpdateFavList:s.a.func,onLoad:s.a.func,zaEnabled:s.a.bool,handleAdd:s.a.func,handleCloseModal:s.a.func.isRequired,onFavlistAdd:s.a.func,authRequired:s.a.func,isUserActive:s.a.bool,defaultStatus:s.a.oneOf(["list","add","edit"]),handleBack:s.a.func,hasFavlists:s.a.bool,editItem:s.a.shape({type:s.a.oneOf(["collection"])}),onUpdateFavContent:s.a.func};var F=L,x=(n(1600),{list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"},edit:{title:"编辑收藏夹"}}),A=function(e){var t=e.shown,n=e.items,r=e.id,s=e.type,u=e.onFetchRelations,p=e.relations,b=e.onClose,h=e.isUserActive,f=e.authRequired,v=e.defaultStatus,C=e.onUpdateFav,O=e.isDrained,j=e.isFetching,y=e.onLoad,g=e.zaEnabled,k=e.onFavlistAdd,w=e.editItem,N=e.onUpdateFavContent,I=Object(c.useState)(v),R=Object(o.a)(I,2),P=R[0],S=R[1],T=Object(c.useRef)([]);Object(c.useEffect)(function(){if(u&&t&&n.length!==T.current.length){T.current=n;var e=(p?n.filter(function(e){return!p[e.id]}):n).map(function(e){return e.id});e.length&&u(r,s,e)}},[r,n,u,p,t,s]),Object(c.useEffect)(function(){"add"===P&&"list"===v&&T.current.length<n.length&&S("list")},[P,v,w,n]);var D=function(){b(),"list"===v&&S("list")},L=!(O&&!n.length),A=Object(d.a)(e,Object.keys(l.b.propTypes)).selectedProps,B=x[P],M=B.tips,E=B.title;return Object(i.b)(l.b,Object(a.default)({},A,{onClose:D,title:E,subtitle:M&&M(L),buttonGroupOnly:!L,className:"FavlistsModal",size:"large"}),t&&Object(i.b)(F,{currentPage:P,items:n,isFetching:j,isDrained:O,relations:p,handleUpdateFavList:function(e,t){var a=n.find(function(t){return t.id===e})||{},o=[e,r,s,a.isPublic];return!t&&m(a.isPublic,h,f)?f(C).apply(void 0,o):C.apply(void 0,o)},onLoad:y,zaEnabled:g,handleAdd:function(){return S("add")},handleCloseModal:D,onFavlistAdd:k,authRequired:f,isUserActive:h,defaultStatus:v,handleBack:function(){return S("list")},hasFavlists:L,editItem:w,onUpdateFavContent:N}))};A.propTypes={id:s.a.oneOfType([s.a.string,s.a.number]),type:s.a.oneOf(["answer","article","pin","zvideo"]),relations:s.a.object,onUpdateFav:s.a.func,onFavlistAdd:s.a.func,onFetchRelations:s.a.func,onClose:s.a.func.isRequired,shown:s.a.bool,zaEnabled:s.a.bool,authRequired:s.a.func,isUserActive:s.a.bool,defaultStatus:s.a.oneOf(["list","add","edit"]),onLoad:s.a.func,editItem:s.a.shape({type:s.a.oneOf(["collection"])}),onUpdateFavContent:s.a.func},A.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}};var B=A;n.d(t,"FavlistsModal",function(){return B})},1657:function(e,t,n){"use strict";n.r(t);var a=n(15),o=n(23),i=n(4),r=n(8),s=n(7),c=n(5),l=n(6),d=n(0),m=n(1),u=n.n(m),p=n(2),b=n.n(p),h=n(12),f=n(9),v=n.n(f),C=n(465),O=n(1623),j=n.n(O),y=n(56),g=n(1437),k=n(45),w=n(26),N=n(43),I=n(126),R=n(27),P=n(74),S=n(467),T=n(618),D=n(1436),L=n(466),F=n(1438),x=n(476),A=n(3),B=n(10),M=(n(1624),5),E=2,q=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={},n.handleClick=function(){var e=n.props,t=e.loadRestComments,a=e.onShowConversation,o=e.comment,i=o.id,r=o.childCommentCount,s=r<=M&&r>E;(s?t:a)({commentId:i}),s&&n.setState(Object(A.a)({},"hide_".concat(i),!0))},n.handleRef=function(e){var t=n.props.onRef;"function"==typeof t&&t(e)},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.id,a=t.childCommentCount,o=e.isFetching,i=e.className,r=this.state["hide_".concat(n)],s=a<=M&&a>E?"展开其他 ".concat(a-E," 条回复"):"查看全部 ".concat(a," 条回复");return Object(d.b)("div",{className:i,ref:this.handleRef},!r&&Object(d.b)("div",{className:"CommentMoreReplyButton"},Object(d.b)(B.c,{preset:"plain",onClick:this.handleClick},s)),o&&Object(d.b)(y.a,{className:"CommentMoreReplyButton",small:!0}))}}]),t}(m.Component);q.propTypes={comment:b.a.object.isRequired,isFetching:b.a.bool,onShowConversation:b.a.func,loadRestComments:b.a.func};n(1625);var z,_=Object(h.connect)(null,{loadConversation:C.g})(z=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).loadRestComments=function(e){var t=e.commentId;(0,n.props.loadConversation)({id:t,isLoadRest:!0})},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.parent,n=t.type,a=t.author,o=(a=void 0===a?{isOrg:!1}:a).isOrg,i=e.parent,r=e.commentNeedsReview,s=e.onShowConversation,c=e.status,l=e.onItemLike,u=e.onItemDelete,p=e.onItemCollapse,b=e.onItemDislike,h=e.onItemApprove,f=e.onItemReject,C=e.canOperateItem,O=e.commentPattern,j=e.conversation,y=void 0===j?{}:j,g=e.entities,k=e.byComment,w=e.isReverseAndStatusOpen,N=e.comment,I=e.onReply,R=e.onFeature,P=e.ids,S=e.showCollapsed,T=N.id,D=N.featured,L=N.childComments,F=void 0===L?[]:L,A=N.childCommentCount,B=void 0===A?0:A,M=D?"".concat(T,"_featured"):"".concat(T),E=!D&&P.includes("".concat(T,"_featured")),z=Boolean(F.length)&&!w,_=B<=5&&B>2,U=F.map(function(e){return g.comments[e]}),V=!D&&B>2&&!w,W=(_&&y[T]||{isFetching:!1}).isFetching;return Object(d.b)(m.Fragment,null,Object(d.b)("li",{className:v()({"NestComment--rootCommentNoChild":!z,"NestComment--rootComment":z}),key:M},Object(d.b)(x.a,{key:M,comment:N,status:c,type:n,parent:i,canOperate:C,commentNeedsReview:r,onShowConversation:s,ownerAuthorIsOrg:o,onLike:l,onReply:I,onFeature:R,onDelete:u,onCollapse:p,onDislike:b,onApprove:h,onReject:f,commentPattern:O,rootCommentId:T,byComment:k,isReverseAndStatusOpen:w,hasRecommend:E,showCollapsed:S})),z&&U.map(function(e){var t=e.id,a=e.featured,m=a?"".concat(t,"_featured"):"".concat(t),v=!a&&P.includes("".concat(t,"_featured"));return Object(d.b)("li",{className:"NestComment--child",key:m},Object(d.b)(x.a,{key:m,comment:e,status:c,type:n,parent:i,canOperate:C,commentNeedsReview:r,onShowConversation:s,ownerAuthorIsOrg:o,onLike:l,onReply:I,onFeature:R,onDelete:u,onCollapse:p,onDislike:b,onApprove:h,onReject:f,commentPattern:O,rootCommentId:T,hasRecommend:v,showCollapsed:S}))}),V&&Object(d.b)(q,{comment:N,isFetching:W,onShowConversation:s,loadRestComments:this.loadRestComments}))}}]),t}(m.Component))||z;function U(e){var t=e.id,n=e.replyTo,a=e.isConversation;if(e.isNotification)return{type:"notification"};if(a)return{type:"conversation"};if(!n)return{type:"comment"};var o=n.featured,i=n.replyToAuthor,r=n.id;return t===r&&o?i?{type:"replyToSubFeatured"}:{type:"replyToFeatured"}:t!==r||i?t!==r&&i?{type:"replyToSubCommon"}:{type:"comment"}:{type:"replyToCommon"}}n(1626);var V,W,K,H=Object(h.connect)(function(e,t){var n=t.parent,a=t.parent,o=a.type,i=a.id,r=t.status,s=t.order,c=t.byComment,l=t.commentPattern,d=t.notificationId,m=e.entities,u=e.commentsV2,p=e.commentsV2,b=p.conversation,h=p.stickers,f=void 0===h?[]:h,v=p.commentWithPicPermission,C=p.notificationsComments,O="".concat(o,"_").concat(i),y=u.parent,g=m.comments[c],k=u.pagination;"reviewing"===r&&(k=u.reviewing);var w="reverse"===s&&"open"===r;w&&(k=u.reverse);var N=[],I=u.collapsed[O]||{};I.ids&&I.ids.length>0&&(N=I.ids.map(function(e){return m.comments[e]}));d&&(k=C,O=d);var S=k[O]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},T=S.isFetching,D=S.isPrevDrained,L=S.isDrained,F=S.ids,x=S.newIds,A=void 0===x?[]:x,B=S.totals,M="bottom"!==l?F:A,E=M.map(function(e){return m.comments[e]}),q=j()(M,function(e){return String(e).includes("_featured")});return{currentUser:Object(R.b)(e),isFetching:T,isPrevDrained:D,isDrained:L,totals:d?E.length:B,collapsedInfo:I,collapsedComments:N,targetComment:g,conversation:b,entities:m,stickers:f,lastFeaturedIndex:q,comments:E,isReverseAndStatusOpen:w,commentWithPicPermission:v,ids:M,parent:Object.assign({},n,{},y[O]),permission:Object(P.j)(e)}},{loadComments:C.f,loadConversation:C.g,addComment:C.a,loadStickers:C.j,clearNotification:w.d,getCommentWithPicPermission:C.e,loadNotificationComments:C.i,loadAnswerCommentPermission:N.j,loadArticleCommentPermission:I.b})((K=W=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={collapsed:!0,current:1},n.commentsWithPaginationElRef=u.a.createRef(),n.load=function(e,t,a){if(!n.props.isFetching&&!n.props.parent.adminClosedComment){var o=e||n.props,i=o.order,r=o.status,s=o.parent,c=s.id,l=s.type,d=o.commentPattern,m=o.needLoadCommentPermission,u=o.loadComments,p=o.notificationId,b=o.loadNotificationComments;if(p)return b(p);if(m&&n.loadCommentPermission(l,c),a){u(l,c,{order:i,isPrevious:t,status:"collapsed",commentPattern:d},!0)}else u(l,c,{order:i,isPrevious:t,status:r,commentPattern:d})}},n.addComment=function(e,t,a,o,i){var r=a.rootCommentId,s=a.isConversation,c=n.props,l=c.parent,d=l.id,m=l.type,u=c.commentId,p=c.addComment,b=c.notificationId;return p({parentType:m,parentId:d,content:e,replyTo:t,conversationId:u,rootCommentId:r,isConversation:s,notificationId:b,replyType:U({id:r,replyTo:t,isConversation:s,isNotification:Boolean(b)}).type,useStrictMode:o,enableUnfriendlyCheck:i})},n.featureItem=function(e){(0,n.props.onItemFeature)(e,n.lastFeaturedIndex)},n.handleOpenCollapsed=function(){n.setState({collapsed:!1}),n.load(n.props,!1,!0)},n.handlePageSelect=function(e){var t=n.props.onPaginationClick,a=n.state.current;t&&t(a,e),n.commentsElement.scrollIntoView(),n.setState({current:e}),n.loadByPagination(e)},n.loadByPagination=function(e,t){var a=t||n.props,o=a.order,i=a.status,r=a.parent,s=r.id,c=r.type,l=a.commentPattern,d=a.needLoadCommentPermission,m=a.loadComments;d&&n.loadCommentPermission(c,s),m(c,s,{order:o,isPrevious:!1,status:i,commentPattern:l,current:e})},n.renderComment=function(e){var t=e.id,o=e.featured?"".concat(t,"_featured"):t,i=!n.state.collapsed;return Object(d.b)("ul",{className:"NestComment",key:o},Object(d.b)(_,Object(a.default)({comment:e,onReply:n.addComment,onFeature:n.featureItem,showCollapsed:i},n.props)))},n.renderNormalComments=function(e){var t=n.state.collapsed,a=n.props,o=a.byComment,i=a.lastFeaturedIndex,r=a.parent,s=r.featuredCounts,c=r.commonCounts,l=[],m=s>0;return n.lastFeaturedIndex=0,e.length>0&&e.forEach(function(a,r){if(o||!a.collapsed){var u=e[r-1];a.collapsed&&(u&&u.collapsed||l.push(n.renderCollapsedDivider()),t)||(r===i&&l.push(Object(d.b)("div",{className:"NestComment-nextSiblings--noBorder",key:"NestComment-nextSiblings--noBorder"})),m&&0===r&&-1!==i&&l.push(Object(d.b)("div",{className:"CommentListV2-header-divider",key:"divider-featured"},"精选评论（",s,"）")),l.push(n.renderComment(a)),r===i&&(n.lastFeaturedIndex=r,l.push(Object(d.b)("div",{className:"CommentListV2-header-divider",key:"divider-comment"},"评论（",c,"）"))))}}),l},n.renderCollapsedComments=function(){var e=n.props,t=e.collapsedComments,a=e.isDrained,o=e.parent,i=(o=void 0===o?{}:o).collapsedCounts;return!a||i<=0?[]:t.map(function(e){return n.renderComment(e)})},n.renderComments=function(e){return e.map(n.renderComment)},n.renderCollapsedDivider=function(){var e=n.props,t=e.isDrained,a=e.parent.collapsedCounts;return!t||a<=0?[]:n.state.collapsed?Object(d.b)("div",{className:"CommentListV2-action",key:"collapsed"},Object(d.b)("div",{className:"CommentListV2-expendCollapseButton"},Object(d.b)("span",{onClick:n.handleOpenCollapsed},Object(k.formatNumber)(a)," 条评论被折叠"),"（",Object(d.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):Object(d.b)("div",{className:"CommentListV2-divider",key:"divider-collapsed"},Object(d.b)("div",{className:"CommentListV2-dividerLine"}),Object(d.b)("div",{className:"CommentListV2-dividerText"},Object(k.formatNumber)(a)," 条评论被折叠（",Object(d.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},n.renderCollapsedInfiLoader=function(){var e=n.state.collapsed;if(e)return[];var t=n.props.collapsedInfo,a=(t=void 0===t?{}:t).isFetching,o=t.isPrevDrained,i=t.isDrained;return Object(d.b)(y.b,{className:"CommentListV2",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:a,isPrevDrained:o,isDrained:i,onLoad:function(t){return n.load(n.props,t,!e)},placeholder:Object(d.b)(y.a,{className:"CommentItem",small:!0})},n.renderCollapsedComments())},n.renderPatternContent=function(e){var t=n.props,a=t.isFetching,o=t.parent.adminClosedComment,i=t.byComment,r=t.status,s=t.order,c=t.totals,l=t.showPackupButton,m=t.handlePackupButton,u=Math.ceil(c/20),p=n.state.current;return o?null:a?Object(d.b)(D.a,null):Object(d.b)("div",{ref:n.commentsWithPaginationElRef},Object(d.b)("div",{className:"CommentListV2"},"normal"===s&&"open"===r?n.renderNormalComments(e):n.renderComments(e)),u>1&&Object(d.b)(g.a,{className:"CommentsV2-pagination",current:p,total:u,onSelect:n.handlePageSelect}),!i&&n.renderCollapsedDivider(),!i&&n.renderCollapsedInfiLoader(),l&&Object(d.b)(F.a,{onClick:m,commentsElRef:n.commentsWithPaginationElRef}))},n.renderModalContent=function(e){var t=n.props,o=t.collapsedInfo,i=t.parent.adminClosedComment,r=t.status,s=t.order,c=t.byComment,l=n.state.collapsed,m=l?n.props:o,u=m.isFetching,p=m.isDrained,b=m.isPrevDrained;if(p&&e.length<=0||i)return Object(d.b)("div",{className:"CommentsV2-empty"},Object(d.b)(S.d,null,Object(d.b)(S.a,null),Object(d.b)("div",null,"还没有评论")));return Object(d.b)(y.b,Object(a.default)({className:"CommentListV2",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:u,isPrevDrained:b,isDrained:p,onLoad:function(e){return n.load(n.props,e,!l)},placeholder:Object(d.b)(y.a,{className:"CommentItemV2",small:!0})},{getContainer:function(e){return e}}),"normal"===s&&"open"===r?n.renderNormalComments(e):n.renderComments(e),!c&&n.renderCollapsedDivider(),!c&&n.renderCollapsedComments())},n.renderCommentEdit=function(){var e=n.props,t=e.parent,a=t.canComment,o=(a=void 0===a?{status:!0}:a).status,i=a.reason,r=t.author,s=(r=void 0===r?{isOrg:!1}:r).isOrg,c=t.type,l=t.id,m=t.adminClosedComment,u=t.questionType,p=e.byComment,b=e.autoFocus,h=e.commentNeedsReview,f=e.zaInfo,C=m?"当前内容暂时无法评论":i,O=b&&!p;return o&&!m?Object(d.b)(T.a,{className:"CommentsV2-footer",type:c,id:l,commentNeedsReview:h,onSubmit:n.addComment,autoFocus:O,ownerAuthorIsOrg:s,ownerAuthorIsBrand:"commercial"===u,zaInfo:f}):Object(d.b)("div",{className:v()("CommentsV2-disabledText")},Object(d.b)("div",{className:"CommentsV2-disabledReason"},C))},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"loadCommentPermission",value:function(e,t){var n=this.props,a=n.loadAnswerCommentPermission,o=n.loadArticleCommentPermission;switch(e){case"answer":return a(t);case"article":return o(t);default:return null}}},{key:"componentDidMount",value:function(){var e=this.props,t=e.commentPattern,n=e.parent.adminClosedComment,a=e.stickers,o=e.loadStickers,i=e.getCommentWithPicPermission,r=e.commentWithPicPermission,s=e.currentUser,c=this.state.current;"bottom"!==t||n||this.loadByPagination(c),!a.length&&o(),void 0===r.commentWithPic&&s&&i()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,a=t.status,o=t.targetComment,i=t.commentPattern;n===e.order&&a===e.status||("bottom"===i?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var r=e.targetComment;r!==o&&r&&this.setState({collapsed:r.collapsed})}},{key:"componentWillUnmount",value:function(){Object(w.d)(w.b)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.comments,i=t.commentPattern,r=t.commentInputPosition,s=t.isAuthor,c=t.parent,l=c.author,m=(l=void 0===l?{isOrg:!1}:l).isOrg,u=c.commentPermission,p=c.reviewingCounts,b=c.commentCount,h=c.adminClosedComment,f=t.totals,C=t.status,O=t.order,j=t.onStatusChange,y=t.onOrderChange,g=t.targetLink,k=t.shouldReverse,w=t.permission.canBrandAdminEdit,N="censor"===u&&(s||w),I=N?{isCommentReviewer:N,onStatusChange:j,status:C,reviewingCounts:p}:{status:C};return Object(d.b)("div",{className:v()("CommentsV2 CommentsV2--withEditor",{"CommentsV2-withPagination":"bottom"===i},n),ref:function(t){e.commentsElement=t}},Object(d.b)(L.a,Object(a.default)({commentCount:void 0!==b?b:f,shouldReverse:k,commentClosed:h,targetLink:g,order:O,onOrderChange:y,commentPattern:i,isOrg:m},I)),"top"===r&&this.renderCommentEdit(),"bottom"===i?this.renderPatternContent(o):this.renderModalContent(o),"bottom"===r&&this.renderCommentEdit())}}]),t}(m.Component),W.propTypes={type:b.a.string,parent:b.a.object.isRequired,targetLink:b.a.node,commentNeedsReview:b.a.bool,byComment:b.a.oneOfType([b.a.number,b.a.string]),commentPattern:b.a.string,commentInputPosition:b.a.oneOf(["top","bottom"]),showPackupButton:b.a.bool,handlePackupButton:b.a.func,onPaginationClick:b.a.func,autoFocus:b.a.bool,shouldReverse:b.a.bool},W.contextTypes={authRequired:b.a.func.isRequired},W.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0,shouldReverse:!0},V=K))||V;var G,Z,J,Q=n(33),$=n(13),X=n(113),Y=n.n(X),ee=n(223),te=n.n(ee),ne=n(40),ae=n(1365),oe=Object(h.connect)(function(e,t){var n=t.conversationId,a=t.isAnchorComments,o=e.entities.comments,i=e.commentsV2,r=i.conversation,s=i.conversationMore,c=r[n]||{isFetching:!1,isDrained:!1,isPrevDrained:!1,ids:[]},l=c.isFetching,d=c.isDrained,m=c.isPrevDrained,u=c.ids,p=c.totals,b=c.topComments,h=(b=void 0===b?{}:b).paging,f=(h||{}).isEnd,v=s[n]||{isFetching:!1,isDrained:!1,ids:[]},C=v.isFetching,O=v.isDrained,j=v.ids,y=j.map(function(e){return o[e]}),g=u.map(function(e){return o[e]}),k=o["".concat(n,"_featured")]||o[n]||{},w=a?te()(j.length?[].concat(Object($.a)(g.slice(0,4)),Object($.a)(y),Object($.a)(g.slice(4))):g,"id"):[k].concat(Object($.a)(g)),N=h?[].concat(Object($.a)(g.slice(0,3)),Object($.a)(y)).length:-1;return{isFetching:l,isDrained:d,isPrevDrained:m,totals:p,comments:w,openComment:k,topCommentsPaging:h,isConversationMoreFetching:C,isConversationMoreDrained:f||O,offsetIndex:N}},{loadConversation:C.g,addComment:C.a,loadMoreAnchorComments:C.h})((J=Z=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).load=function(){var e=n.props,t=e.isAnchorComments,a=e.conversationId;(0,e.loadConversation)({id:a,isAnchorComments:t})},n.addComment=function(e,t,a){var o=a.rootCommentId,i=a.isConversation,r=n.props,s=r.parent,c=s.type,l=s.id,d=r.conversationId,m=r.addComment,u=r.isAnchorComments;return m({parentType:c,parentId:l,content:e,replyTo:t,conversationId:d,rootCommentId:o,isConversation:i,replyType:U({id:o,replyTo:t,isConversation:i}).type,isAnchorComments:u})},n.loadMoreAnchorComments=function(){var e=n.props,t=e.conversationId,a=e.topCommentsPaging,o=void 0===a?{}:a;(0,e.loadMoreAnchorComments)({conversationId:t,nextUrl:o.next})},n.createOnRef=Y()(function(e){return function(t){var a=n.props.byComment;parseInt(e)===Number(a)&&(n.targetCommentEl=t)}}),n.scrollToTarget=function(){var e=Object(Q.default)(n),t=e.targetCommentEl,a=e.listEl;if(a&&t){var o=t.getBoundingClientRect(),i=o.top,r=o.height,s=a.getBoundingClientRect(),c=s.top,l=s.height;n.listEl.scrollTop+=i-c-(l-r)/2,t.classList.add("CommentItemV2--highlighted"),setTimeout(function(){return t.classList.remove("CommentItemV2--highlighted")},2e3),t.tabIndex=-1,t.focus()}},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.byComment&&this.scrollToTarget()}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onItemLike,a=t.onItemDelete,o=t.onItemFeature,i=t.onItemApprove,r=t.onItemCollapse,s=t.onItemDislike,c=t.onNavBack,l=t.canOperateItem,u=t.isFetching,p=t.comments,b=void 0===p?[]:p,h=t.commentNeedsReview,f=t.openComment.collapsed,v=t.parent,C=t.commentPattern,O=t.totals,j=t.isDrained,g=t.isPrevDrained,k=t.isConversationMoreFetching,w=t.isConversationMoreDrained,N=t.offsetIndex,I=null;return u&&!b.length?I=Object(d.b)(m.Fragment,null,Object(d.b)(y.a,{className:"CommentItemV2",small:!0}),Object(d.b)("div",{className:"CommentsV2-openComment-divider"}),Object(d.b)("div",{className:"CommentsV2-replyNum"},"".concat(O," 条回复"))):b.length&&(I=b.map(function(t,c){return c?w||c!==N||k?k&&c===N?Object(d.b)(m.Fragment,{key:t.id},Object(d.b)(x.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:i,onCollapse:r,onDislike:s,collapsedShown:f,onReply:e.addComment}),Object(d.b)(y.a,{key:"NestCoomment-moreCommentButton-PlaceHolder",className:"NestCoomment-moreCommentButton ",small:!0})):Object(d.b)(x.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:i,onCollapse:r,onDislike:s,collapsedShown:f,onReply:e.addComment}):Object(d.b)(m.Fragment,{key:t.id},Object(d.b)(x.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:i,onCollapse:r,onDislike:s,collapsedShown:f,onReply:e.addComment}),Object(d.b)("div",{key:"NestCoomment-moreCommentButton",preset:"plain",className:"NestCoomment-moreCommentButton",onClick:e.loadMoreAnchorComments},Object(d.b)(ae.a,null),Object(d.b)("p",null,"点击查看更多回复"))):Object(d.b)(m.Fragment,{key:t.id},Object(d.b)("div",{className:"CommentsV2-openComment"},Object(d.b)(x.a,{key:t.id,onRef:e.createOnRef(t.id),isConversation:!0,commentNeedsReview:h,canOperate:l,parent:v,comment:t,onLike:n,onDelete:a,onFeature:o,onApprove:i,onCollapse:r,onDislike:s,collapsedShown:f,onReply:e.addComment})),Object(d.b)("div",{className:"CommentsV2-openComment-divider"}),Object(d.b)("div",{key:"".concat(t.id,"-title")},Object(d.b)("div",{className:"CommentsV2-replyNum"},"".concat(O," 条回复"))))})),"bottom"===C?Object(d.b)(ne.b,{size:"fullPage",onClose:c},Object(d.b)("div",{className:"CommentsV2"},Object(d.b)(L.a,{isConversation:!0,commentPattern:C}),Object(d.b)(y.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:u,isDrained:j,isPrevDrained:g,onLoad:this.load,placeholder:Object(d.b)(y.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},I))):Object(d.b)("div",{className:"CommentsV2"},Object(d.b)(L.a,{isConversation:!0,onNavBack:c}),Object(d.b)(y.b,{className:"CommentListV2",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:u,isDrained:j,isPrevDrained:g,onLoad:this.load,placeholder:Object(d.b)(y.a,{className:"CommentItemV2",small:!0}),getContainer:function(e){return e}},I))}}]),t}(m.Component),Z.propTypes={conversationId:b.a.number.isRequired,type:b.a.string,parent:b.a.object.isRequired,commentNeedsReview:b.a.bool},Z.contextTypes={currentUser:b.a.object,authRequired:b.a.func.isRequired},G=J))||G;var ie,re,se,ce=n(60);n.d(t,"default",function(){return le});var le=Object(h.connect)(null,{updateCommentLikeStatus:C.o,updateCommentFeatureStatus:C.n,deleteComment:C.d,updateCommentCollapsed:C.l,updateCommentDisliked:C.m,approveComment:C.b,rejectComment:C.k})(ie=Object(ce.a)(null)((se=re=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).state={openedCommentId:null,isAnchorComments:!1,status:"open",order:"normal"},n.showConversation=function(e){var t=e.commentId,a=e.isAnchorComments;n.setState({openedCommentId:t,isAnchorComments:a})},n.showComments=function(){n.setState({openedCommentId:null,isAnchorComments:!1})},n.delete=function(e){var t=n.props,a=t.parent;return(0,t.deleteComment)(e,a.type,a.id)},n.feature=function(e){var t=n.props,a=t.parent,o=t.updateCommentFeatureStatus,i=t.notificationId;o({id:n.state.openedCommentId,commentId:e,parentId:a.id,parentType:a.type,notificationId:i})},n.like=function(e,t){var a=n.props,o=a.onItemLike,i=a.updateCommentLikeStatus;o&&o(e,t),i(e)},n.collapse=function(e){var t=n.props,a=t.parent;(0,t.updateCommentCollapsed)(e,a.type,a.id)},n.dislike=function(e){(0,n.props.updateCommentDisliked)(e)},n.approve=function(e){var t=n.props,a=t.parent,o=t.type;(0,t.approveComment)(e,a.type||o,a.id)},n.reject=function(e){var t=n.props,a=t.parent,o=t.type;(0,t.rejectComment)(e,a.type||o,a.id)},n.handleStatusChange=function(e){n.setState({status:e})},n.handleOrderChange=function(e,t){var a=n.props.onOrderChange;a&&a(e,t),n.setState({order:e})},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.commentsContainerNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.containerClassName,r=t.parent,s=t.commentPattern,c=t.type,l=t.parent,m=(l=void 0===l?{}:l).commentPermission,u=l.relationship,p=void 0===u?{}:u,b=l.author,h=void 0===b?{}:b,f=t.needLoadCommentPermission,C=t.byComment,O=Object(o.a)(t,["className","containerClassName","parent","commentPattern","type","parent","needLoadCommentPermission","byComment"]),j=this.context.currentUser,y=void 0===p.isAuthor?j&&h.urlToken&&j.urlToken===h.urlToken:p.isAuthor,g="censor"===m&&!y,k="answer"===c||"article"===c,w=this.state,N=w.openedCommentId,I=w.status,R=w.order,P=w.isAnchorComments,S=P&&(N||C)||C;return Object(d.b)("div",{className:v()("Comments-container",i),ref:function(t){return e.commentsContainerNode=t}},Object(d.b)(H,Object(a.default)({className:v()(n,{"CommentsV2--hidden":N&&"bottom"!==s})},O,{type:c,order:R,status:I,parent:r,commentPattern:s,commentNeedsReview:g,canOperateItem:k,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,byComment:S,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:f,isAuthor:y})),N&&Object(d.b)(oe,Object(a.default)({},O,{parent:r,type:c,canOperateItem:k,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve,onItemReject:this.reject,commentPattern:s,conversationId:N,onNavBack:this.showComments,byComment:S,isAnchorComments:P,commentNeedsReview:g,onShowConversation:this.showConversation})))}}]),t}(m.Component),re.propTypes={type:b.a.string.isRequired,parent:b.a.object.isRequired,onOrderChange:b.a.func,onItemLike:b.a.func,isAuthor:b.a.bool,onMount:b.a.func},re.defaultProps={type:"answer"},re.contextTypes={currentUser:b.a.object,authRequired:b.a.func.isRequired},ie=se))||ie)||ie},1658:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(8),i=n(7),r=n(5),s=n(6),c=n(0),l=n(1),d=n.n(l),m=n(2),u=n.n(m),p=n(9),b=n.n(p),h=n(10),f=n(36),v=n(623),C=n(55),O=n(1348),j=n(1627),y=n.n(j),g=n(1628),k=n.n(g),w=n(33),N=(n(1629),8),I=9,R=13,P=48,S=57;function T(e,t){return e?t?!0===t?"":t:e:""}var D=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).onInputFocus=n.onInputFocus.bind(Object(w.default)(n)),n.onInputChange=n.onInputChange.bind(Object(w.default)(n)),n.onKeyDown=n.onKeyDown.bind(Object(w.default)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"onInputFocus",value:function(){this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var n=this.props.chars,a=this.props.length;n.length===a?n=n.replace(/.$/,t):n+=t,this.props.onChange(n),n.length===a&&this.props.onFinish(n)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==I&&t!==R){var n=this.props.chars;t===N?(n=n.slice(0,-1),this.props.onChange(n)):(t<P||t>S)&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this,t=this.props,n=t.length,a=t.chars,o=t.maskChar,i=t.autoFocus,r=t.className,s=t.children,l=a.length===n?n-1:a.length,d=a[l]||"";return Object(c.b)("label",{className:b()("TPass",r)},Object(c.b)("span",{className:"TPass-wrapper"},Object(c.b)(L,{length:n,chars:a,maskChar:o}),Object(c.b)("input",{className:"TPass-input",value:d,style:{left:60*l},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:i,ref:function(t){e.input=t}})),s)}}]),t}(d.a.Component);function L(e){for(var t,n=e.length,a=e.chars,o=e.maskChar,i=[],r=0;r<n;r+=1)t=a[r],i.push(Object(c.b)("span",{className:b()("TPassBox",{"TPassBox-mask":t&&Boolean(o)}),key:r},T(t,o)));return Object(c.b)("span",{className:"TPassBoxes"},i)}D.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},D.propTypes={length:u.a.number,chars:u.a.string,maskChar:u.a.oneOfType([u.a.bool,u.a.string]),autoFocus:u.a.bool,onFocus:u.a.func,onChange:u.a.func,onError:u.a.func,onFinish:u.a.func,className:u.a.string,children:u.a.node};var F=D,x=(n(1630),function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props;return Object(c.b)("div",{className:b()("Spinner",e)},Object(c.b)("i",{className:"Spinner-loading"}))}}]),t}(l.Component));x.propTypes={className:u.a.string};var A=n(162),B=(n(1631),11);function M(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}var E={name:"1qc85lp",styles:"padding:0;border:none;"},q=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).onPasscodeFocus=function(){n.state.error&&(n.setState({error:null}),6===n.state.passcode.length&&n.setState({passcode:""}))},n.onPasscodeInput=function(e){"object"==typeof e&&(e=e.target.value),n.setState({passcode:e})},n.onPasscodeFinish=function(e){n.tpass.blur(),n.payWithBalance(e)},n.onSendSMSCode=function(){n.props.trade.resendSMSCode(function(){n.startSMSTimer(),n.smsInput.focus()},function(e){n.setState({error:e})})},n.onQrLoad=function(){n.setState({qrLoaded:!0})},n.onBalanceFormSubmit=function(e){e.preventDefault(),n.payWithBalance(n.state.passcode)},n.setPayments=function(e){n.setState({payments:e})},n.confirmPayment=function(){var e=n.state,t=e.choseName,a=e.payments,o=n.props.onConfirmPayment,i=t;if(t||(i=a.balance&&a.balance.enable?"balance":"wechat"),o(!i),n.setState({chosePaymentName:i}),"wechat"===i&&n.isInWechat){var r=n.props.tradeNumber,s="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),c="".concat("https://www.zhihu.com/pay/weixin/pay?service_id=".concat(B)+"&trade_number=".concat(r,"&redirect_uri=").concat(encodeURIComponent(s)));window.location.replace(c)}else n.props.trade["wechat"===i?"initWechatPay":"initBalancePay"]()},n.pid=0,n.smsTimer=null,n.state=new M,n.isInWechat=e.ua.Wechat,n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new M),setTimeout(function(){t.getPaymentsList(e.trade)},300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var n=this.pid+=1;e.getPaymentsList(function(e){t.pid===n&&t.setPayments(e)})}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",function(e,n){t.setState(Object.assign({},n))}).on("paySuccess",function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()}).on("payCancel",function(){t.setState({isInProgress:!1,chosePaymentName:null})}).on("payFail",function(e){var n=e;"object"!=typeof e||e instanceof Error||(n=e.message),t.setState({isInProgress:!1,error:n}),t.props.onFail(e)}).on("needSMS",function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})}).on("needWechatCode",function(){t.props.onError("needWechatCode")}).on("error",function(e,n){t.props.onError(e,n)})}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval(function(){(t-=1)<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})},1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e=this,t=this.state,n=t.payments,a=t.chosePaymentName,o=t.choseName,i=this.props.trade;if(a)return null;var r=n.balance&&n.balance.amount,s=i.info.total,l=n.wechat&&n.wechat.enable,d=this.props.balanceEnable,m=n.balance&&n.balance.enable,u=n.balance&&!n.balance.enable,p=d&&r>=s,b="使用余额（剩余 ".concat((r/100).toFixed(2),"）"),f=p?b:"微信支付",v=p?"wallet":"wechatPayment";o&&(f="wechat"===o?"微信支付":b,v="wechat"===o?"wechatPayment":"wallet");var j=Object(c.b)(h.c,{css:E},"wechatPayment"===v?Object(c.b)(k.a,{center:!0}):Object(c.b)(y.a,{center:!0})," ",f,Object(c.b)(O.a,{center:!0}));return Object(c.b)("div",{className:"PaymentsList"},Object(c.b)("span",{className:"Payment-Topline"}),Object(c.b)("span",{className:"PaymentWay"},"支付方式"),Object(c.b)(A.a,{placeholder:j},Object(c.b)(C.b,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",menuToggler:j,onChange:function(t){"disabled"!==t&&e.setState({choseName:t})}},d&&m&&Object(c.b)(C.a,{value:"balance",className:"PaymentItem"},Object(c.b)(y.a,{center:!0}),b),d&&u&&Object(c.b)(C.a,{value:"disabled",className:"PaymentItem PaymentItem--disabled"},Object(c.b)(y.a,{center:!0}),b),l&&Object(c.b)(C.a,{value:"wechat",className:"PaymentItem"},Object(c.b)(k.a,{center:!0}),"微信支付"))),Object(c.b)("span",{className:"Payment-Bottomline"}),Object(c.b)(h.c,{className:"Payment-CheckedButton",onClick:this.confirmPayment},"确认支付"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.trade,o=this.state,i=o.payments,r=o.chosePaymentName,s=o.codeUrl,l=o.needSMS,d=o.isInProgress;return a?Object(c.b)("div",{className:b()("Payment",n)},Object.keys(i).length?this.renderPaymentsList():Object(c.b)("div",{className:"Payment-placeholder"},Object(c.b)(x,null)),"wechat"===r&&Object(c.b)("div",{className:"Payment-wechatPay"},Object(c.b)("div",{className:"Payment-wechatPayTitle"},Object(c.b)("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"),!this.isInWechat&&Object(c.b)("div",null,"使用微信扫描二维码完成支付"),this.state.qrLoaded?Object(c.b)("span",{className:"Payment-qrWrapper"},Object(c.b)("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url=".concat(s),width:"150",height:"150"})):Object(c.b)("div",{className:"Payment-qrPlaceholder"},Object(c.b)(x,null),!this.isInWechat&&Object(c.b)("div",null,"正在生成二维码"),s&&Object(c.b)("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url=".concat(s),width:"1",height:"1",onLoad:this.onQrLoad}))),"balance"===r&&Object(c.b)("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay"},Object(c.b)("div",{className:"Payment-balancePayTitle"},Object(c.b)("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"),!l&&Object(c.b)("div",null,Object(c.b)("div",{className:"Payment-description"},"请输入 6 位数知乎支付密码，用于支付验证。"),Object(c.b)(F,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:b()("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":d}),autoFocus:!0,ref:function(t){e.tpass=t}},d&&Object(c.b)(x,{className:"Payment-balancePaySpinner"}))),Boolean(l)&&Object(c.b)("div",{className:"Payment-balancePaySms"},Object(c.b)("div",{className:"Payment-balancePaySmsText"},String(l)),Object(c.b)("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:b()("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?Object(c.b)("button",{className:"Payment-sendSms",type:"button",disabled:!0},this.state.smsTimer," 秒后可重发"):Object(c.b)("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button"},"发送验证码")),Object(c.b)("div",{className:"Payment-balancePayFooter"},Object(c.b)("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"}},this.state.error),Boolean(l)&&Object(c.b)(h.c,{color:"blue",disabled:d,className:"Payment-balancePayConfirmBtn",type:"submit"},"确认")),!l&&Object(c.b)("div",{className:"Payment-balancePayForget"},"如果忘记密码请邮件联系"," ",Object(c.b)("email",{className:"Payment-email"},"i@zhihu.com")))):Object(c.b)("div",{className:b()("Payment",n)},Object(c.b)("div",{className:"Payment-placeholder Payment-placehoder--empty"},Object(c.b)(x,null)))}}]),t}(d.a.Component);q.propTypes={trade:u.a.object,autoChooseSinglePayment:u.a.bool,onSuccess:u.a.func.isRequired,onFail:u.a.func,onError:u.a.func,onConfirmPayment:u.a.func,balanceEnable:u.a.bool},q.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:"",balanceEnable:!0};var z=q,_=n(207),U="",V=null;var W=n(19);n(1632);n.d(t,"TipjarDialog",function(){return G});var K=[200,500,1e3,5e3,1e4,2e4],H=100,G=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).onConfirmPayment=function(e){n.setState({chosePaymentName:e})},n.onPaySuccess=function(){n.props.onPaySuccess(),n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},n.handleCustomAmount=function(){n.state.trade&&n.state.trade.dispose(),n.setState({showCustom:!0})},n.handleCustomChange=function(e){var t=e.target.value;isNaN(t)?n.setState({customAmount:""}):n.setState({customAmount:parseInt(t)||""})},n.handleCustomKeyUp=function(e){13===e.keyCode&&n.handleSubmitCustom()},n.handleSubmitCustom=function(){var e=n.state.customAmount*H;e>0&&e<=5e4&&(n.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),n.createTrade(e))},n.closeModal=function(){n.state.trade&&n.state.trade.dispose(),n.setState(n.getDefaultState())},n.handleAmountButton=function(e){n.createTrade(e.currentTarget.dataset.amount),n.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},n.createTrade=function(e){n.setState({tradeLoading:!0,currentAmount:e});var t=n.props.ua;n.props.addReward(e,t.Wechat?"wechat":"normal"),n.setState({tradeLoading:!1})},n.colseTijarDialog=function(){n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),n.props.colseTijarDialog()},n.state=n.getDefaultState(),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.tradeNumber,n=e.type,a=this.state,o=a.trade,i=a.colseTijarDialogStatus,r="article"===n?11:17;if(t&&(!o||t!==o.tradeNo)&&!i){var s=new window.zhihu.pay.Trade(t,r);this.setState({trade:s})}}},{key:"componentWillUnmount",value:function(){this.props.TipjarRender&&this.props.removeTradeNumber()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e,t,n=this;e="https://pay.zhihu.com/api/js",t=function(){n.setState({showTipModal:!0})},U&&e&&e!==U&&t(new Error("A pay-sdk from different source has been load")),U=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(V||(V=Object(_.loadScript)(e)),V.then(function(){return window.zhihu.pay.ready(t)},function(e){t(e),V=null}))}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,n=e.customAmount,a=e.currentAmount,o=e.customButton;return Object(c.b)("div",{className:"Reward-TipjarDialog-amountCustom"},t?Object(c.b)("div",{className:"Reward-TipjarDialog-amountInput"},Object(c.b)("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:n,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),Object(c.b)(h.c,{disabled:n<=0||n>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom},"确定"),Object(c.b)("div",{className:"Reward-TipjarDialog-error",style:{display:n>500?"block":"none"}},"不能超过 500 元")):Object(c.b)(h.c,{preset:"plain",className:o?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount},o?"自定义金额： ￥ ".concat(a/H):"自定义金额"))}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,n=t.author,a=n.name,o=n.avatarUrl,i=n.isOrg,r=n.urlToken,s=n.id,l=t.tagline,d=this.state.currentAmount;return Object(c.b)("div",{className:"Reward-TipjarDialog"},Object(c.b)("div",{className:"Reward-TipjarDialog-user"},Object(c.b)("a",{href:"/".concat(i?"org":"people","/").concat(r||s),className:"Reward-UserAvatar"},Object(c.b)("img",{src:o.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})),a),Object(c.b)("div",{className:"Reward-TipjarDialog-tagLine"},l),Object(c.b)("div",{className:"Reward-TipjarDialog-selectAmount"},Object(c.b)("div",{className:"Reward-TipjarDialog-amountList"},K.map(function(t){return Object(c.b)(h.c,{key:t,"data-amount":t,onClick:e.handleAmountButton,color:"red",className:b()({"Reward-Button-checked":Number(d)===t})},Object(c.b)("b",null,Number(d)===t?"".concat(t/H," 元"):"￥ ".concat(t/H)))})),this.renderAmountCustom()))}},{key:"render",value:function(){var e=this.props,t=e.ua,n=e.TipjarRender,a=e.isMobile,o=e.tradeNumber,i=e.balanceEnable,r=this.state,s=r.showCustom,l=r.tradeLoading,d=r.showTipModal,m=r.trade,u=r.chosePaymentName,p=a?v.a:f.b,b=a?"small":"default";return Object(c.b)(p,{overlay:!0,size:b,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal"},n&&Object(c.b)("div",null,d&&u&&this.renderTipjarDialog(),(m||l)&&!s&&Object(c.b)(z,{trade:m,tradeNumber:o,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment,balanceEnable:i})))}}]),t}(l.Component);G.propTypes={author:u.a.object,tagline:u.a.string,colseTijarDialog:u.a.func,addReward:u.a.func,tradeNumber:u.a.number,removeTradeNumber:u.a.func,onPaySuccess:u.a.func,isMobile:u.a.bool,type:u.a.string,balanceEnable:u.a.bool},G.defaultProps={tagline:W.k,balanceEnable:!0}},1660:function(e,t,n){"use strict";n.r(t);var a=n(15),o=n(23),i=n(4),r=n(8),s=n(7),c=n(5),l=n(6),d=n(0),m=n(2),u=n.n(m),p=n(1),b=n.n(p),h=n(12),f=n(9),v=n.n(f),C=n(133),O=n(11),j=n(113),y=n.n(j),g=n(1357),k=n(106),w=n(56),N=n(1437),I=n(10),R=n(45),P=n(96),S=n(26),T=n(43),D=n(126),L=n(467),F=n(473),x=n(472),A=n(1436),B=n(466),M=n(1438);n(1622);function E(e,t){switch(e){case"answer":return Object(T.j)(t);case"article":return Object(D.b)(t);default:return null}}var q=function(e){function t(){var e,n;Object(i.a)(this,t);for(var o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(r)))).state={collapsed:!0,current:1},n.commentsWithPaginationElRef=b.a.createRef(),n.load=function(e,t,a){if(!n.props.isFetching&&!n.props.parent.adminClosedComment){var o=e||n.props,i=o.order,r=o.byComment,s=o.status,c=o.parent,l=c.id,d=c.type,m=o.dispatch,u=o.commentPattern;if(o.needLoadCommentPermission&&E(d,l)&&m(E(d,l)),a){m(Object(C.e)(d,l,{order:i,isPrevious:t,byComment:r,status:"collapsed",commentPattern:u},!0))}else m(Object(C.e)(d,l,{order:i,isPrevious:t,byComment:r,status:s,commentPattern:u}))}},n.addComment=function(e,t){var a=n.props,o=a.parent,i=o.id,r=o.type,s=a.dispatch,c=[r,i,e];return t&&(c[3]=t.id),s(C.a.apply(void 0,c))},n.featureItem=function(e){n.props.onItemFeature(e,n.lastFeaturedIndex)},n.handleOpenCollapsed=function(){n.setState({collapsed:!1}),n.load(n.props,!1,!0)},n.createOnRef=y()(function(e){return function(t){var a=n.props.byComment;e===Number(a)&&(n.targetCommentEl=t)}}),n.handlePageSelect=function(e){var t=n.props.onPaginationClick,a=n.state.current;t&&t(a,e),n.commentsElement.scrollIntoView(),n.setState({current:e}),n.loadByPagination(e)},n.loadByPagination=function(e,t){var a=t||n.props,o=a.order,i=a.byComment,r=a.status,s=a.parent,c=s.id,l=s.type,d=a.dispatch,m=a.commentPattern;a.needLoadCommentPermission&&E(l,c)&&d(E(l,c)),d(Object(C.e)(l,c,{order:o,isPrevious:!1,byComment:i,status:r,commentPattern:m,current:e}))},n.renderComment=function(e){var t=n.props,a=t.parent,o=a.type,i=a.author,r=(i=void 0===i?{isOrg:!1}:i).isOrg,s=t.isMobile,c=t.parent,l=t.commentNeedsReview,m=t.onShowConversation,u=t.status,p=t.onItemLike,b=t.onItemDelete,h=t.onItemCollapse,f=t.onItemDislike,v=t.onItemApprove,C=t.canOperateItem,O=t.commentPattern;return Object(d.b)(x.a,{key:e.id,isMobile:s,comment:e,onRef:n.createOnRef(e.id),status:u,type:o,parent:c,canOperate:C,commentNeedsReview:l,onShowConversation:m,ownerAuthorIsOrg:r,onLike:p,onReply:n.addComment,onFeature:n.featureItem,onDelete:b,onCollapse:h,onDislike:f,onApprove:v,commentPattern:O})},n.renderNormalComments=function(e){var t=n.state.collapsed,a=n.props.byComment,o=[];if(n.lastFeaturedIndex=0,e.length>0){var i=e[0].featured,r=!1;e.forEach(function(s,c){if(a||!s.collapsed){var l=e[c-1];if(!s.collapsed||(l&&l.collapsed||o.push(n.renderCollapsedDivider()),!t)){o.push(n.renderComment(s));var m=e[c+1];i&&!r&&s.featured&&(!m||!m.featured)&&(r=!0,n.lastFeaturedIndex=c,o.push(Object(d.b)("div",{className:"CommentList-divider",key:"divider-featured"},Object(d.b)("div",{className:"CommentList-dividerLine"}),Object(d.b)("div",{className:"CommentList-dividerText"},"以上为精选评论",Object(d.b)(g.a,{className:"CommentList-questionMark","data-tooltip":"精选评论包含回答作者推荐的评论和部分高赞评论",center:!0,size:16})))))}}})}return o},n.renderCollapsedComments=function(){var e=[],t=n.props.collapsedComments;return n.state.collapsed||!t||t.length<=0?[]:(e.push(t.map(function(e){return n.renderComment(e)})),e)},n.renderComments=function(e){return e.map(n.renderComment)},n.renderCollapsedDivider=function(){var e=n.props,t=e.isDrained,a=e.parent.collapsedCounts;return!t||a<=0?[]:n.state.collapsed?Object(d.b)("div",{className:"CommentList-action",key:"collapsed"},Object(d.b)("div",{className:"CommentList-expendCollapseButton"},Object(d.b)("span",{onClick:n.handleOpenCollapsed},Object(R.formatNumber)(a)," 条评论被折叠"),"（",Object(d.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）")):Object(d.b)("div",{className:"CommentList-divider",key:"divider-collapsed"},Object(d.b)("div",{className:"CommentList-dividerLine"}),Object(d.b)("div",{className:"CommentList-dividerText"},Object(R.formatNumber)(a)," 条评论被折叠（",Object(d.b)("a",{href:"//www.zhihu.com/question/52029856/answer/128623557",target:"_blank",rel:"noopener noreferrer"},"为什么？"),"）"))},n.renderCollapsedInfiLoader=function(){var e=n.state.collapsed;if(e)return[];var t=n.props.collapsedInfo,a=(t=void 0===t?{}:t).isFetching,o=t.isPrevDrained,i=t.isDrained;return Object(d.b)(w.b,{className:"CommentList",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:a,isPrevDrained:o,isDrained:i,onLoad:function(t){return n.load(n.props,t,!e)},placeholder:Object(d.b)(w.a,{className:"CommentItem",small:!0})},n.renderCollapsedComments())},n.renderPatternContent=function(e){var t=n.props,a=t.isFetching,o=t.parent.adminClosedComment,i=t.byComment,r=t.status,s=t.order,c=t.totals,l=t.showPackupButton,m=t.handlePackupButton,u=Math.ceil(c/20),p=n.state.current;return o?null:a?Object(d.b)(A.a,null):Object(d.b)("div",{ref:n.commentsWithPaginationElRef},Object(d.b)("div",{className:"CommentList"},"normal"===s&&"open"===r?n.renderNormalComments(e):n.renderComments(e)),u>1&&Object(d.b)(N.a,{className:"comments-pagination",current:p,total:u,onSelect:n.handlePageSelect}),!i&&n.renderCollapsedDivider(),!i&&n.renderCollapsedInfiLoader(),l&&Object(d.b)(M.a,{onClick:m,commentsElRef:n.commentsWithPaginationElRef}))},n.renderModalContent=function(e){var t=n.props,o=t.collapsedInfo,i=t.parent.adminClosedComment,r=t.status,s=t.order,c=t.byComment,l=n.state.collapsed,m=l?n.props:o,u=m.isFetching,p=m.isDrained,b=m.isPrevDrained;if(p&&e.length<=0||i)return Object(d.b)("div",{className:"Comments-empty"},Object(d.b)(L.d,null,Object(d.b)(L.a,null),Object(d.b)("div",null,"还没有评论")));var h={getContainer:function(e){return e}};return Object(d.b)(w.b,Object(a.default)({className:"CommentList",onRef:function(e){n.listEl=e},isLocal:!0,isLoading:u,isPrevDrained:b,isDrained:p,onLoad:function(e){return n.load(n.props,e,!l)},placeholder:Object(d.b)(w.a,{className:"CommentItem",small:!0})},h),"normal"===s&&"open"===r?n.renderNormalComments(e):n.renderComments(e),!c&&n.renderCollapsedDivider(),!c&&n.renderCollapsedComments())},n.renderCommentEdit=function(e){var t=n.props,o=t.parent,i=o.canComment,r=(i=void 0===i?{status:!0}:i).status,s=i.reason,c=o.author,l=(c=void 0===c?{isOrg:!1}:c).isOrg,m=o.type,u=o.id,p=o.adminClosedComment,b=o.questionType,h=t.byComment,f=t.autoFocus,C=t.commentNeedsReview,j=p?"当前内容暂时无法评论":s,y=f&&!h;return r&&!p?Object(d.b)(F.a,Object(a.default)({className:"Comments-".concat("top"===e?"top":"footer"),type:m,id:u,commentNeedsReview:C,onSubmit:n.addComment,autoFocus:y,ownerAuthorIsOrg:l,ownerAuthorIsBrand:"commercial"===b},"top"===e&&{preset:"default",onClick:function(e){O.default.trackEvent(e.target,{id:3905})}})):"top"!==e&&Object(d.b)("div",{className:v()("Comments-disabledText",{"Comments-disabledText--fixed":void 0})},Object(d.b)("div",{className:"Comments-disabledReason"},j))},n.renderBottomButton=function(){var e=n.props.params,t=e.id,a=e.answerId,o=Boolean(a);return Object(d.b)("div",{className:"Comments-footer CommentEditor--normal"},Object(d.b)(I.c,{className:"CommentEditor-startCommentButton",preset:"primary",color:"blue",onClick:function(){return Object(k.b)(Object(P.a)(o?{type:"answer",id:a}:{type:"question",id:t},{utm_content:"comment_area"}),{zaProps:{id:3906}})}},"打开 App 参与站内讨论"))},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.byComment,n=e.commentPattern,a=e.parent.adminClosedComment,o=this.state.current;t&&this.scrollToTarget(),"bottom"!==n||a||this.loadByPagination(o)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,a=t.status,o=t.targetComment,i=t.commentPattern;n===e.order&&a===e.status||("bottom"===i?(this.setState({current:1}),this.loadByPagination(1,e)):this.load(e),this.setState({collapsed:!0}));var r=e.targetComment;!o&&r&&this.setState({collapsed:!r.collapsed})}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Object(S.d)(S.b))}},{key:"scrollToTarget",value:function(){var e=this.targetCommentEl,t=this.listEl;if(t&&e){var n=e.getBoundingClientRect(),a=n.top,o=n.height,i=t.getBoundingClientRect(),r=i.top,s=i.height;this.listEl.scrollTop+=a-r-(s-o)/2,e.classList.add("CommentItem--highlighted"),setTimeout(function(){return e.classList.remove("CommentItem--highlighted")},2e3),e.tabIndex=-1,e.focus()}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,o=t.isAuthor,i=t.comments,r=t.commentPattern,s=t.commentInputPosition,c=t.parent,l=c.author,m=(l=void 0===l?{isOrg:!1}:l).isOrg,u=c.commentPermission,p=c.reviewingCounts,b=c.commentCount,h=c.adminClosedComment,f=t.totals,C=t.status,O=t.order,j=t.onStatusChange,y=t.onOrderChange,g=t.targetLink,k=i.filter(function(e){return!e.isDelete}),w="censor"===u&&o,N=w?{isCommentReviewer:w,onStatusChange:j,status:C,reviewingCounts:p}:{status:C},I=v()({Comments:!0,"Comments--withEditor":!0,"Comments-withPagination":"bottom"===r},n);return Object(d.b)("div",{className:I,ref:function(t){e.commentsElement=t}},Object(d.b)(B.a,Object(a.default)({commentCount:void 0!==b?b:f,commentClosed:h,targetLink:g,order:O,onOrderChange:y,commentPattern:r,isOrg:m,options:this.renderCommentEdit("top")},N)),"top"===s&&this.renderCommentEdit(),"bottom"===r?this.renderPatternContent(k):this.renderModalContent(k),"bottom"===s&&this.renderCommentEdit())}}]),t}(p.Component);q.propTypes={type:u.a.string,parent:u.a.object.isRequired,targetLink:u.a.node,commentNeedsReview:u.a.bool,byComment:u.a.oneOfType([u.a.number,u.a.string]),commentPattern:u.a.string,commentInputPosition:u.a.oneOf(["top","bottom"]),showPackupButton:u.a.bool,handlePackupButton:u.a.func,onPaginationClick:u.a.func,autoFocus:u.a.bool},q.contextTypes={authRequired:u.a.func.isRequired},q.defaultProps={commentInputPosition:"bottom",showPackupButton:!0,autoFocus:!0};var z=Object(h.connect)(function(e,t){var n=t.parent,a=t.parent,o=a.type,i=a.id,r=t.status,s=t.order,c=t.byComment,l=t.commentPattern,d=e.entities,m=e.comments,u="".concat(o,"_").concat(i),p=m.parent,b=m.pagination;"reviewing"===r&&(b=m.reviewing),"reverse"===s&&"open"===r&&(b=m.reverse);var h=[],f=m.collapsed[u]||{};f.ids&&f.ids.length>0&&(h=f.ids.map(function(e){return d.comments[e]}));var v=b[u]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},C=v.isFetching,O=v.isPrevDrained,j=v.isDrained,y=v.ids,g=v.newIds,k=void 0===g?[]:g;return{isFetching:C,isPrevDrained:O,isDrained:j,totals:v.totals,comments:("bottom"!==l?y:k).map(function(e){return d.comments[e]}),collapsedInfo:f,collapsedComments:h,targetComment:d.comments[c],parent:Object.assign({},n,{},p[u])}})(q),_=n(33),U=n(40);var V=function(e){function t(e,n){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e,n))).load=a.load.bind(Object(_.default)(a)),a.addComment=n.authRequired(a.addComment.bind(Object(_.default)(a)),void 0,S.b),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){this.props.dispatch(Object(C.f)(this.props.commentId))}},{key:"addComment",value:function(e,t){var n=this.props,a=n.parent,o=a.type,i=a.id,r=n.commentId,s=n.dispatch,c=[o,i,e,t.id,r];return s(C.a.apply(void 0,c))}},{key:"render",value:function(){var e,t,n,a=this.props,o=a.onItemLike,i=a.onItemDelete,r=a.onItemFeature,s=a.onItemApprove,c=a.onItemCollapse,l=a.onItemDislike,m=a.onNavBack,u=a.canOperateItem,p=a.isFetching,b=a.comments,h=a.commentNeedsReview,f=a.openComment.collapsed,v=a.parent,C=a.parent.canComment,O=(C=void 0===C?{status:!0}:C).status,j=C.reason,y=a.commentPattern,g=a.commentId,k=this.context.currentUser;return Boolean(k&&b.find(function(e){return e.author&&e.author.member.urlToken===k.urlToken}))&&(t=(e=b.filter(function(e){return e.author&&e.author.member.urlToken!==k.urlToken}))[e.length-1]),p&&!b.length?n=Object(d.b)(w.a,{className:"CommentItem",small:!0}):b.length&&(n=b.map(function(e,t){return Object(d.b)(x.a,{key:t,isConversation:!0,commentNeedsReview:h,canOperate:u,parent:v,comment:e,onLike:o,onDelete:i,onFeature:r,onApprove:s,onCollapse:c,onDislike:l,collapsedShown:f})})),"bottom"===y?Object(d.b)(U.b,{size:"fullPage",onClose:m},Object(d.b)("div",{className:"Comments"},Object(d.b)(B.a,{isConversation:!0,commentPattern:y}),Object(d.b)("div",{className:"CommentList"},n))):Object(d.b)("div",{className:"Comments"},Object(d.b)(B.a,{isConversation:!0,onNavBack:m}),Object(d.b)("div",{className:"CommentList"},n),t&&(O?Object(d.b)(F.a,{id:g,type:"conversation",className:"Comments-footer",replyTo:t,commentNeedsReview:h,onSubmit:this.addComment}):Object(d.b)("div",{className:"Comments-disabledText"},j)))}}]),t}(p.Component);V.propTypes={commentId:u.a.number.isRequired,type:u.a.string,parent:u.a.object.isRequired,commentNeedsReview:u.a.bool},V.contextTypes={currentUser:u.a.object,authRequired:u.a.func.isRequired};var W,K,H,G=Object(h.connect)(function(e,t){var n=t.commentId,a=e.entities.comments,o=e.comments.conversation[n]||{isFetching:!1,isDrained:!1,ids:[]};return{isFetching:o.isFetching,isDrained:o.isDrained,comments:o.ids.map(function(e){return a[e]}),openComment:a[n]}})(V),Z=n(60),J=Object(Z.a)(null)((H=K=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={openedCommentId:null,status:"open",order:"normal"},n.like=function(e,t){var a=n.props,o=a.onItemLike,i=a.dispatch;o&&o(e,t),i(Object(C.j)(e))},n.collapse=function(e){var t=n.props,a=t.dispatch,o=t.parent;a(Object(C.g)(e,o.type,o.id))},n.dislike=function(e){return n.props.dispatch(Object(C.h)(e))},n.approve=function(e){var t=n.props,a=t.dispatch,o=t.parent,i=t.type;a(Object(C.b)(e,o.type||i,o.id))},n.handleStatusChange=function(e){n.setState({status:e})},n.handleOrderChange=function(e,t){n.props.onOrderChange&&n.props.onOrderChange(e,t),n.setState({order:e})};var a=e.parent,o=e.dispatch;return n.feature=function(e,t){return o(Object(C.i)(e,a.id,a.type,t))},n.delete=function(e){return o(Object(C.d)(e,a.type,a.id))},n.showConversation=function(e){return n.setState({openedCommentId:e})},n.showComments=function(){return n.setState({openedCommentId:null})},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.onMount;e&&e(this.domNode)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.containerClassName,r=t.parent,s=t.commentPattern,c=t.type,l=t.parent,m=(l=void 0===l?{}:l).commentPermission,u=l.relationship,p=void 0===u?{}:u,b=l.author,h=void 0===b?{}:b,f=t.needLoadCommentPermission,C=Object(o.a)(t,["className","containerClassName","parent","commentPattern","type","parent","needLoadCommentPermission"]),O=this.context.currentUser,j=void 0===p.isAuthor?O&&h.urlToken&&O.urlToken===h.urlToken:p.isAuthor,y="censor"===m&&!j,g="answer"===c||"article"===c,k=this.state,w=k.openedCommentId,N=k.status,I=k.order,R={commentNeedsReview:y,parent:r,type:c,canOperateItem:g,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve};return Object(d.b)("div",{className:v()("Comments-container",i),ref:function(t){return e.domNode=t}},Object(d.b)(z,Object(a.default)({},C,R,{commentPattern:s,className:v()(n,{"Comments--hidden":w&&"bottom"!==s}),order:I,status:N,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,needLoadCommentPermission:f,isAuthor:j})),w&&Object(d.b)(G,Object(a.default)({},C,R,{commentPattern:s,commentId:w,onNavBack:this.showComments})))}}]),t}(p.Component),K.propTypes={type:u.a.string.isRequired,parent:u.a.object.isRequired,onOrderChange:u.a.func,onItemLike:u.a.func,isAuthor:u.a.bool,onMount:u.a.func},K.defaultProps={type:"answer"},K.contextTypes={currentUser:u.a.object,authRequired:u.a.func.isRequired},W=H))||W;t.default=Object(h.connect)()(J)}}]);
//# sourceMappingURL=column.modals.69abadf09c0a64329317.js.map